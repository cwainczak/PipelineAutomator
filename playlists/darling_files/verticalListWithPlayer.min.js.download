/*! EnsembleVideo - v5.4.0 */

(function(e){(function(i){"use strict";var t=function(){try{if(i.URLSearchParams&&new i.URLSearchParams("foo=bar").get("foo")==="bar"){return i.URLSearchParams}}catch(e){}return null}(),e=t&&new t({a:1}).toString()==="a=1",r=t&&new t("s=%2B").get("s")==="+",a="__URLSearchParams__",n=t?function(){var e=new t;e.append("s"," &");return e.toString()==="s=+%26"}():true,s=o.prototype,l=!!(i.Symbol&&i.Symbol.iterator);if(t&&e&&r&&n){return}function o(e){e=e||"";if(e instanceof URLSearchParams||e instanceof o){e=e.toString()}this[a]=m(e)}s.append=function(e,t){g(this[a],e,t)};s["delete"]=function(e){delete this[a][e]};s.get=function(e){var t=this[a];return this.has(e)?t[e][0]:null};s.getAll=function(e){var t=this[a];return this.has(e)?t[e].slice(0):[]};s.has=function(e){return y(this[a],e)};s.set=function e(t,i){this[a][t]=[""+i]};s.toString=function(){var e=this[a],t=[],i,r,n,s;for(r in e){n=c(r);for(i=0,s=e[r];i<s.length;i++){t.push(n+"="+c(s[i]))}}return t.join("&")};var h=!r;var u=!h&&t&&!e&&i.Proxy;Object.defineProperty(i,"URLSearchParams",{value:u?new Proxy(t,{construct:function(e,t){return new e(new o(t[0]).toString())}}):o});var d=i.URLSearchParams.prototype;d.polyfill=true;d.forEach=d.forEach||function(i,r){var e=m(this.toString());Object.getOwnPropertyNames(e).forEach(function(t){e[t].forEach(function(e){i.call(r,e,t,this)},this)},this)};d.sort=d.sort||function(){var e=m(this.toString()),t=[],i,r,n;for(i in e){t.push(i)}t.sort();for(r=0;r<t.length;r++){this["delete"](t[r])}for(r=0;r<t.length;r++){var s=t[r],a=e[s];for(n=0;n<a.length;n++){this.append(s,a[n])}}};d.keys=d.keys||function(){var i=[];this.forEach(function(e,t){i.push(t)});return f(i)};d.values=d.values||function(){var t=[];this.forEach(function(e){t.push(e)});return f(t)};d.entries=d.entries||function(){var i=[];this.forEach(function(e,t){i.push([t,e])});return f(i)};if(l){d[i.Symbol.iterator]=d[i.Symbol.iterator]||d.entries}function c(e){var t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'\(\)~]|%20|%00/g,function(e){return t[e]})}function p(e){return e.replace(/[ +]/g,"%20").replace(/(%[a-f0-9]{2})+/gi,function(e){return decodeURIComponent(e)})}function f(t){var e={next:function(){var e=t.shift();return{done:e===undefined,value:e}}};if(l){e[i.Symbol.iterator]=function(){return e}}return e}function m(e){var t={};if(typeof e==="object"){if(v(e)){for(var i=0;i<e.length;i++){var r=e[i];if(v(r)&&r.length===2){g(t,r[0],r[1])}else{throw new TypeError("Failed to construct 'URLSearchParams': Sequence initializer must only contain pair elements")}}}else{for(var n in e){if(e.hasOwnProperty(n)){g(t,n,e[n])}}}}else{if(e.indexOf("?")===0){e=e.slice(1)}var s=e.split("&");for(var a=0;a<s.length;a++){var l=s[a],o=l.indexOf("=");if(-1<o){g(t,p(l.slice(0,o)),p(l.slice(o+1)))}else{if(l){g(t,p(l),"")}}}}return t}function g(e,t,i){var r=typeof i==="string"?i:i!==null&&i!==undefined&&typeof i.toString==="function"?i.toString():JSON.stringify(i);if(y(e,t)){e[t].push(r)}else{e[t]=[r]}}function v(e){return!!e&&"[object Array]"===Object.prototype.toString.call(e)}function y(e,t){return Object.prototype.hasOwnProperty.call(e,t)}})(typeof global!=="undefined"?global:typeof window!=="undefined"?window:this);var l=function(e){return{formatTime:function(e){if(e===0){return"00:00:00"}var t=new Date(1970,0,1);t.setSeconds(e);return t.toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/,"$1")},insideIframe:function(){try{return window.self!==window.top}catch(e){return true}},setThumbnailParameters:function(e,t,i,r){return e.replace(/[{}]/g,"").replace("width,","width="+t).replace("height,","&height="+i).replace("bgColor","&bgColor="+r)},getIdentityRefreshInterval:function(e){var t=new URLSearchParams(e);var i=t.get("idn_expiry");if(i===undefined)return 0;var r=621355968e9;var n=i-r;var s=n/1e4;var a=new Date(s);var l=s-Date.now()-6e4;console.log("Next Expiration: "+a+", Refresh Interval: "+l);return l>0?l:0},overrideParameter:function(e,t,i){if(e===undefined||e===null||t===null||t===undefined||t==="")return e;if(e.toLowerCase().indexOf(t.toLowerCase())>-1){e=e.replace(new RegExp("("+t+"=).*?(&|$)","ig"),"$1"+i+"$2")}else{e=e.indexOf("?")>-1||e.toLowerCase().indexOf("http")===-1?e+"&"+t+"="+i:e+"?"+t+"="+i}return e},overrideIdentityParams:function(e,t){for(var i in t){var r=t[i];if(r!==undefined&&r!==null&&r!=="")e=this.overrideParameter(e,i,r)}return e},setPreviewUrl:function(e,t,i,r,n){if(i)e=this.overrideParameter(e,"autoPlay","true");e=this.overrideParameter(e,"isResponsive","true");e=this.overrideParameter(e,"displayMenu","false");e=this.setContentPreviewParameter(e,t);e=this.appendCustomQuery(e,r);e=this.appendCustomQuery(e,n);return e},setLaunchUrl:function(e,t,i,r){e=this.appendCustomQuery(e,t);e=this.appendCustomQuery(e,i);e=this.appendCustomQuery(e,r);return e},appendCustomQuery:function(e,t){if(t===undefined||t===null||t==="")return e;return e.indexOf("?")>-1?e+"&"+t:e+"?"+t},setContentPreviewParameter:function(e,t){if(t===undefined||t===null)return e;if(t.toLowerCase().indexOf("iscontentpreview=true")===-1)return e;e=e.toLowerCase().indexOf("/quiz/")===-1?this.overrideParameter(e,"isContentPreview","true"):this.overrideParameter(e,"isQuizPreview","true");return e},findByPropertyValue:function(e,t,i){return e.filter(function(e){if(e[t]===i){return e}return null})[0]},getDefaultPlaybackSource:function(e){var t=this.findByPropertyValue(e,"isDefault","true");if(t===null||t===undefined)t=e[0].filePath;return t},getStoragePreference:function(e){var t;try{t=localStorage.getItem(e.key)}catch(e){console.error(e.message)}if(!t)t=e.defaultValue;return t},getOrSetStoragePreference:function(e){var t;try{t=localStorage.getItem(e.key)}catch(e){console.error(e.message)}if(!t){t=e.defaultValue;try{localStorage.setItem(e.key,e.defaultValue)}catch(e){console.error(e.message)}}return t},setStoragePreference:function(e){localStorage.setItem(e.key,e.value)},stringToBool:function(e){return e!==undefined&&e!==null&&e!==""&&e.toLowerCase()==="true"}}}(e);define(["jquery","moment","moment-timezone"],function(s,n,e){"use strict";window.EnsembleVideo=window.EnsembleVideo||{};window.EnsembleVideo.Hal=function(e){this.rootUrl=e.rootUrl;this.setting=e.setting;this.brandingUrl=null;this.fallbackThumbnailUrl=null;this.brandingUrlPath=[{name:"ev:Brandings/Current",type:"link"},{name:"href",type:"property"}];this.nextPagePath=[{name:"next",type:"link"},{name:"href",type:"property"}];this.selfPath=[{name:"self",type:"link"},{name:"href",type:"property"}];this.playlistTitlePath=[{name:"ev:Playlists/Get",type:"embed"},{name:"title",type:"property"}];this.playlistLogoPath=[{name:"ev:Playlists/Get",type:"embed"},{name:"logo",type:"property"}];this.playlistPublishedCategoriesPath=[{name:"ev:Playlists/Get",type:"embed"},{name:"publishedCategories",type:"property"}];this.quizThumbnailPath=[{name:"ev:Quizzes/Get",type:"embed"},{name:"ev:Contents/Get",type:"embed"},{name:"ev:Images/Thumbnail",type:"link"},{name:"href",type:"property"}];this.contentThumbnailPath=[{name:"ev:Contents/Get",type:"embed"},{name:"ev:Images/Thumbnail",type:"link"},{name:"href",type:"property"}];this.quizPluginPath=[{name:"ev:Quizzes/Get",type:"embed"},{name:"ev:QuizPlugin/Get",type:"link"},{name:"href",type:"property"}];this.contentPluginPath=[{name:"ev:Contents/Get",type:"embed"},{name:"ev:Plugin/Get",type:"link"},{name:"href",type:"property"}];this.quizLaunchPath=[{name:"ev:Quizzes/Get",type:"embed"},{name:"ev:QuizPlugin/Launch",type:"link"},{name:"href",type:"property"}];this.contentLaunchPath=[{name:"ev:Contents/Get",type:"embed"},{name:"ev:Plugin/Launch",type:"link"},{name:"href",type:"property"}];this.quizJavascriptPluginPath=[{name:"ev:Quizzes/Get",type:"embed"},{name:"ev:QuizPlugin/JavaScript",type:"link"},{name:"href",type:"property"}];this.contentJavascriptPluginPath=[{name:"ev:Contents/Get",type:"embed"},{name:"ev:Plugin/JavaScript",type:"link"},{name:"href",type:"property"}];this.quizViewsCountPath=[{name:"ev:Quizzes/Get",type:"embed"},{name:"ev:Contents/Get",type:"embed"},{name:"viewsCount",type:"property"}];this.contentViewsCountPath=[{name:"ev:Contents/Get",type:"embed"},{name:"viewsCount",type:"property"}];this.contentWorkflowTypePath=[{name:"ev:Contents/Get",type:"embed"},{name:"workflowType",type:"property"}]};window.EnsembleVideo.Hal.prototype={initialize:function(t){var i=this;this.get(this.rootUrl,{},function(e){i.brandingUrl=i.parseHalObject(e,i.brandingUrlPath,"");i.getFallbackThumbnail(t)})},get:function(e,t,i,r){s.ajax({cache:false,type:"get",headers:{Accept:"application/hal+json, application/json, */*; q=0.01"},url:e,data:t,xhrFields:{withCredentials:true},success:function(e){if(i!==undefined)i(e)},error:function(e,t){if(r!==undefined)r(e,t)}})},delete:function(e,t,i){s.ajax({cache:false,type:"delete",headers:{Accept:"application/hal+json, application/json, */*; q=0.01"},url:e,success:function(e){if(t!==undefined)t(e)},error:function(e,t){if(i!==undefined)i(e,t)}})},parseHalObject:function(i,e,r){var n=null;s.each(e,function(e,t){if(n===null)n=i;if(t.type==="embed"){n=n._embedded[t.name]}if(t.type==="link"){n=n._links[t.name]}if(t.type==="property"){n=n[t.name]}if(n===null||n===undefined){n=r;return false}});return n},parsePublish:function(e){var t="";var i="";var r="0";var n="";var s="";var a=false;if(e.isQuiz){t=this.parseHalObject(e,this.quizPluginPath,"");i=this.parseHalObject(e,this.quizLaunchPath,"");n=this.parseHalObject(e,this.quizThumbnailPath,this.fallbackThumbnailUrl);s=this.parseHalObject(e,this.quizJavascriptPluginPath,"")}else{t=this.parseHalObject(e,this.contentPluginPath,"");i=this.parseHalObject(e,this.contentLaunchPath,"");r=this.parseHalObject(e,this.contentViewsCountPath,"0");n=this.parseHalObject(e,this.contentThumbnailPath,this.fallbackThumbnailUrl);s=this.parseHalObject(e,this.contentJavascriptPluginPath,"");a=this.parseHalObject(e,this.contentWorkflowTypePath,"")==="YouTube"}return{id:e.id,isQuiz:e.isQuiz,name:e.title,dateProduced:this.convertToUserDateTime(e.dateProduced,this.setting.timeZone,this.setting.dateFormat),duration:l.formatTime(e.duration),thumbnailUrl:n,viewsCount:r,pluginUrl:t,launchUrl:i,javascriptPluginUrl:s,isYoutube:a}},getFallbackThumbnail:function(t){var i=this;this.get(this.brandingUrl,{},function(e){i.fallbackThumbnailUrl=e.thumbnailImageUrlTemplate;t()})},convertToUserDateTime:function(t,e,i){try{var r=n.utc(t).tz(e).toDate();return this.formatDateTime(r,i)}catch(e){console.log(e);return t}},formatDateTime:function(e,t){return n(e).format(t)}}});(function(u){window.EnsembleVideo=window.EnsembleVideo||{};window.EnsembleVideo.VerticalListWithPlayerPlugin=function(e){this.requestId=e.requestId;this.filter=e.filter;this.api=e.api;this.setting=e.setting;this.isResponsive=l.stringToBool(e.isResponsive);this.adjustHeight=l.stringToBool(e.adjustHeight);this.localization=e.localization;this.autoPlayFeaturedContent=l.stringToBool(e.autoPlayFeaturedContent);this.isFeaturedContentDefined=l.stringToBool(e.isFeaturedContentDefined);this.forceIframe=l.stringToBool(e.forceIframe);this.contentQueryString=e.contentQueryString;this.viewingContextQueryString=e.viewingContextQueryString;this.refreshIdentity=e.refreshIdentity;this.identityQueryString=e.identityQueryString;this.identityParams={};this.identityRefreshInterval=0;this.isPreview=l.stringToBool(e.isPreview);this.view="list";this.nextPageUrl=null;this.playlist=null;this.playlistLoaded=false;this.isFeaturedContentRetrieved=false;this.featuredContentData=null;this.loaderIdSelector="#loading_spinner_"+this.requestId;this.moreLoaderIdSelector="#loading_spinner_more_"+this.requestId;this.refreshLoaderSelector="#pl-refresh-loader-"+this.requestId;this.pluginSelector="#pl_plugin_"+this.requestId;this.pluginPlayerSelector="#pl_plugin_player_"+this.requestId;this.itemsCollectionSelector="#pl_collection_"+this.requestId;this.itemsContainerSelector="#pl_items_container_"+this.requestId;this.itemsCountSelector="#pl_items_count_"+this.requestId;this.categoriesBlockSelector="#pl_categories_block_"+this.requestId;this.categoriesSelector="#pl_categories_"+this.requestId;this.searchSelector="#pl_search_"+this.requestId;this.searchBtnSelector="#pl_search_btn_"+this.requestId;this.listViewSelector="#pl_list_view_"+this.requestId;this.gridViewSelector="#pl_grid_view_"+this.requestId;this.iframePlayerTemplateSelector="#pl_tmpl_iframe_player_"+this.requestId;this.javascriptPlayerTemplateSelector="#pl_tmpl_javascript_player_"+this.requestId;this.headerBlocksSelector=".ev-pl-header-info_"+this.requestId+", .ev-pl-header-filter_"+this.requestId;this.pluginPlayerBlockSelector=".ev-pl-plugin-player_"+this.requestId;this.pluginListBlockSelector=".ev-pl-plugin-list_"+this.requestId;this.headerSelector=".ev-pl-header_"+this.requestId;this.emptySelector="#pl_empty_"+this.requestId;this.listItemTemplateSelector="#pl_tmpl_list_item_"+this.requestId;this.listItemImgSelector=".ev-pl-list-item-img_"+this.requestId;this.listItemDescSelector=".ev-pl-list-item-desc_"+this.requestId;this.embedContainerSelector="#"+e.embedContainerId;this.logoSelector="#pl-header-logo-"+this.requestId;this.launchSelector=".ev-pl-launch-"+this.requestId;this.gridItemTemplateSelector="#pl_tmpl_grid_item_"+this.requestId;this.gridItemImgSelector=".ev-pl-grid-item-img_"+this.requestId;this.gridItemsSelector=".ev-pl-grid-item_"+this.requestId;this.listItemsSelector=".ev-pl-list-item_"+this.requestId;this.gridItemOverlaySelector=".ev-pl-grid-item-info-overlay-"+this.requestId;this.gridItemLaunchSelector=".ev-pl-link-launch";this.playableItemsSelector=".ev-pl-list-play_"+this.requestId+", .ev-pl-grid-play_"+this.requestId;this.clearItemsSelector=".ev-pl-list-item_"+this.requestId+", .ev-pl-grid-item_"+this.requestId+", .ev-pl-grid-row_"+this.requestId;this.loadMoreLoaderSelector=".ev-pl-loader_"+this.requestId;this.clickRegisteredSelector=".click-registered"+this.requestId;this.clickRegisteredClass="click-registered"+this.requestId;this.listItemImgResponsiveClass="ev-pl-item-3";this.listItemDescResponsiveClass="ev-pl-item-9";this.headerBlockResponsiveClass="ev-pl-item-6";this.pluginPlayerResponsiveClass="ev-pl-item-8";this.pluginListResponsiveClass="ev-pl-item-4 ev-pull-right";this.thumbnailWidth=0;this.thumbnailHeight=0;this.viewPreferenceStorageKey="ev.preference.playlist.view"};window.EnsembleVideo.VerticalListWithPlayerPlugin.prototype={initialize:function(){u(this.loaderIdSelector).css("display","table");if(!this.isPreview){this.view=l.getStoragePreference({key:this.viewPreferenceStorageKey,defaultValue:this.view})}this.hal=new window.EnsembleVideo.Hal({rootUrl:this.api.rootUrl,setting:this.setting});this.handleIdentityRefresh();var i=this;this.hal.initialize(function(){if(i.isFeaturedContentDefined){i.hal.get(i.api.featuredContentUrl,{},function(e){i.featuredContentData=e;i.isFeaturedContentRetrieved=true},function(e,t){i.isFeaturedContentRetrieved=true;i.loadFirstItem()})}i.hal.get(i.api.playlistUrl,i.filter,function(e){i.playlist=i.parseData(e);i.playlistLoaded=true;if(i.playlist.itemsCount===0){i.renderEmptyPlaylist();return}u(i.loaderIdSelector).css("display","none");u(i.logoSelector).show();i.renderHeader();i.handlePluginResize();i.handleHeaderResize();i.adjustPluginHeight();i.render();i.handleInitialActions();if(i.isFeaturedContentDefined){i.renderFeaturedItem()}else{i.loadFirstItem()}})})},handleIdentityRefresh:function(){if(!this.refreshIdentity||this.identityQueryString===undefined||this.identityQueryString===null||this.identityQueryString==="")return;this.identityRefreshInterval=l.getIdentityRefreshInterval(this.identityQueryString);if(this.identityRefreshInterval===0)return;var t=this;setTimeout(function(){var e=l.appendCustomQuery(t.api.pluginIdentityUrl,t.identityQueryString);console.log("Refreshing Identity: "+t.identityQueryString);t.hal.get(e,{},function(e){t.identityQueryString=e.identityQuery;t.identityParams={idn_playlist:e.playlistId,idn_content:e.contentId,idn_dropbox:e.dropboxId,idn_ref:e.ref,idn_pp:e.playlistPa,idn_cp:e.contentPa,idn_dp:e.dropboxPa,idn_ua:e.ua,idn_pe:e.isPe,idn_init:e.isInit,idn_expiry:e.expiry,idn_sig:e.signature};t.handleIdentityRefresh()},function(e,t){location.reload(true)})},this.identityRefreshInterval)},renderFeaturedItem:function(){if(!this.isFeaturedContentRetrieved){var e=this;setTimeout(function(){e.renderFeaturedItem()},500);return}if(this.featuredContentData===null)return;var t=this.hal.parsePublish(this.featuredContentData);t.pluginUrl=l.setPreviewUrl(t.pluginUrl,this.contentQueryString,this.autoPlayFeaturedContent,this.identityQueryString,this.viewingContextQueryString);t.javascriptPluginUrl=l.setPreviewUrl(t.javascriptPluginUrl,this.contentQueryString,this.autoPlayFeaturedContent,this.identityQueryString,this.viewingContextQueryString);this.loadPlayer(t)},parseData:function(e){if(e===null||e===undefined)return null;this.nextPageUrl=this.hal.parseHalObject(e,this.hal.nextPagePath,undefined);var i={name:this.hal.parseHalObject(e,this.hal.playlistTitlePath,""),logo:this.hal.parseHalObject(e,this.hal.playlistLogoPath,undefined),items:[],itemsCount:e.totalItemsCount,categories:this.hal.parseHalObject(e,this.hal.playlistPublishedCategoriesPath,[])};var r=this;u.each(e._embedded.publishing,function(e,t){i.items.push(r.hal.parsePublish(t))});return i},renderEmptyPlaylist:function(){u(this.loaderIdSelector).css("display","none");u(this.emptySelector).show()},render:function(){var e=u(this.itemsCollectionSelector);e.find(this.clearItemsSelector).remove();if(this.view==="list"){this.renderList(this.playlist.items)}else{this.renderGrid(this.playlist.items);while(e.children().height()<e.outerHeight()&&this.hasNextPage()){this.loadMore(e)}}},renderMore:function(e){if(this.view==="list"){this.renderList(e)}else{this.renderGrid(e)}},renderList:function(e){var r=this;u.each(e,function(e,t){var i=u(r.listItemTemplateSelector).tmpl({id:t.id,isQuiz:t.isQuiz,name:t.name,duration:t.duration,pluginUrl:t.pluginUrl,javascriptPluginUrl:t.javascriptPluginUrl,launchUrl:l.setLaunchUrl(t.launchUrl,r.contentQueryString,r.identityQueryString,r.viewingContextQueryString),viewsCount:t.viewsCount,dateProduced:t.dateProduced,thumbnailUrl:l.setThumbnailParameters(t.thumbnailUrl,300,169,"Black"),isYoutube:t.isYoutube});u(r.itemsContainerSelector).append(i)});this.handleItemsActions();this.handleListResize()},renderGrid:function(e){var r=this;u.each(e,function(e,t){var i=u(r.gridItemTemplateSelector).tmpl({id:t.id,isQuiz:t.isQuiz,name:t.name,duration:t.duration,pluginUrl:t.pluginUrl,javascriptPluginUrl:t.javascriptPluginUrl,launchUrl:l.setLaunchUrl(t.launchUrl,r.contentQueryString,r.identityQueryString,r.viewingContextQueryString),viewsCount:t.viewsCount,dateProduced:t.dateProduced,thumbnailUrl:l.setThumbnailParameters(t.thumbnailUrl,300,169,"Black"),isYoutube:t.isYoutube});u(r.itemsContainerSelector).append(i)});this.handleItemsActions();this.handleGridResize()},renderHeader:function(){this.renderVideosCount();this.renderSearch();this.renderCategories()},renderVideosCount:function(){var e=this.playlist.itemsCount>1?this.localization.videos:this.localization.video;u(this.itemsCountSelector).text(this.playlist.itemsCount+" "+e)},renderSearch:function(){if(this.filter.search!==null&&this.filter.search!==undefined)u(this.searchSelector).val(this.filter.search)},renderCategories:function(){if(this.playlist.categories.length<2)return;var r=u(this.categoriesSelector);r.empty().append(u('<option value="-1">'+this.localization.viewAll+"</option>"));u.each(this.playlist.categories,function(e,t){var i=u("<option></option>");i.attr("value",t.id).text(t.title);r.append(i)});u(this.categoriesBlockSelector).removeClass("ev-hidden")},handleInitialActions:function(){var t=this;u(this.gridViewSelector).on("click",function(){if(t.view==="grid")return;t.view="grid";if(!t.isPreview){l.setStoragePreference({key:t.viewPreferenceStorageKey,value:"grid"})}u(t.clearItemsSelector).remove();t.renderGrid(t.playlist.items);t.handleGridResize();var e=u(t.itemsCollectionSelector);while(e.children().height()-200<e.outerHeight()&&t.hasNextPage()){t.loadMore(e)}});u(this.listViewSelector).on("click",function(){if(t.view==="list")return;t.view="list";if(!t.isPreview){l.setStoragePreference({key:t.viewPreferenceStorageKey,value:"list"})}u(t.clearItemsSelector).remove();t.renderList(t.playlist.items);t.handleListResize()});u(this.searchBtnSelector).on("click",function(){u(t.clearItemsSelector).remove();t.refresh()});u(this.searchSelector).on("keyup",function(e){if(e.which===13){u(t.searchBtnSelector).click()}});u(this.categoriesSelector).on("change",function(){u(t.clearItemsSelector).remove();t.refresh()});u(this.itemsCollectionSelector).on("scroll",function(){var e=u(this);if(Math.abs(e[0].scrollHeight-e.scrollTop()-e.outerHeight())<1){t.loadMore(e)}});if(this.isResponsive){u(window).on("resize",function(){t.handlePluginResize();t.handleGridResize();t.handleListResize();t.handleHeaderResize();t.adjustPluginHeight()})}},adjustPluginHeight:function(){if(!this.adjustHeight)return;var e=0;if(this.isPlayerInFullWidth()){e=u(this.pluginPlayerBlockSelector).height()+u(this.pluginListBlockSelector).height()+350}else{e=u(this.pluginPlayerBlockSelector).height()}u(this.embedContainerSelector).css("height",e+20+"px")},handlePluginResize:function(){var e=u(this.pluginSelector);var t=u(this.pluginPlayerBlockSelector);var i=u(this.pluginListBlockSelector);var r=this.pluginPlayerResponsiveClass;var n=this.pluginListResponsiveClass;var s=e.width();if(s>=800){this.pluginPlayerResponsiveClass="ev-pl-item-8";this.pluginListResponsiveClass="ev-pl-item-4 ev-pull-right"}else{this.pluginPlayerResponsiveClass="ev-pl-item-12";this.pluginListResponsiveClass="ev-pl-item-12 ev-pull-right"}t.removeClass(r).addClass(this.pluginPlayerResponsiveClass);i.removeClass(n).addClass(this.pluginListResponsiveClass);t.css("display","block");if(this.isPlayerInFullWidth()){e.addClass("ev-pl-player-full");var a=e.width();var l=a*.5625;t.css("height",l+"px");i.css("height","calc(100% - "+(l+10)+"px)")}else{e.removeClass("ev-pl-player-full");var o=t.width();var h=o*.5625;t.css("height",h+"px");i.css("height",h+"px")}i.css("display","block")},handleGridResize:function(){if(this.view!=="grid")return;var e=u(this.gridItemsSelector);var t=this.gridItemResponsiveClass;var i=u(this.pluginListBlockSelector).width();if(i>=800){this.gridItemResponsiveClass="ev-pl-item-3";this.thumbnailWidth=i*25/100-38;this.thumbnailHeight=this.thumbnailWidth*.5625}else if(i>=650){this.gridItemResponsiveClass="ev-pl-item-4";this.thumbnailWidth=i*33.3/100-38;this.thumbnailHeight=this.thumbnailWidth*.5625}else if(i>=400){this.gridItemResponsiveClass="ev-pl-item-6";this.thumbnailWidth=i*50/100-38;this.thumbnailHeight=this.thumbnailWidth*.5625}else{this.gridItemResponsiveClass="ev-pl-item-12";this.thumbnailWidth=i-38;this.thumbnailHeight=this.thumbnailWidth*.5625}e.removeClass(t).addClass(this.gridItemResponsiveClass);e.find(this.gridItemImgSelector).css("width",this.thumbnailWidth+"px").css("height",this.thumbnailHeight+"px");e.css("height",this.thumbnailHeight+"px")},handleListResize:function(){if(this.view!=="list")return;var e=u(this.listItemsSelector);var t=this.listItemImgResponsiveClass;var i=this.listItemDescResponsiveClass;var r=u(this.pluginListBlockSelector).width();if(r>=300){this.listItemImgResponsiveClass="ev-pl-item-3";this.listItemDescResponsiveClass="ev-pl-item-9";this.thumbnailWidth=r*25/100;this.thumbnailHeight=this.thumbnailWidth*.5625}else{this.listItemImgResponsiveClass="ev-pl-item-12";this.listItemDescResponsiveClass="ev-pl-item-12";this.thumbnailWidth=r;this.thumbnailHeight=this.thumbnailWidth*.5625}e.find(this.listItemImgSelector).removeClass(t).addClass(this.listItemImgResponsiveClass).css("width",this.thumbnailWidth+"px").css("height",this.thumbnailHeight+"px");e.find(this.listItemDescSelector).removeClass(i).addClass(this.listItemDescResponsiveClass)},handleHeaderResize:function(){var e=u(this.headerBlocksSelector);var t=this.headerBlockResponsiveClass;var i=u(this.itemsContainerSelector).width();if(i>=500){this.headerBlockResponsiveClass="ev-pl-item-6"}else{this.headerBlockResponsiveClass="ev-pl-item-12"}e.removeClass(t).addClass(this.headerBlockResponsiveClass);u(this.headerSelector).css("display","block");this.setScrollerHeight()},handleItemsActions:function(){var e=u(this.playableItemsSelector).not(this.clickRegisteredSelector);var t=e.parent().parent();var r=this;e.on("click",function(e){e.preventDefault();var t=u(this);r.loadPlayer({pluginUrl:l.setPreviewUrl(t.attr("data-plugin-url"),r.contentQueryString,true,r.identityQueryString,r.viewingContextQueryString),javascriptPluginUrl:l.setPreviewUrl(t.attr("data-plugin-javascript-url"),r.contentQueryString,true,r.identityQueryString,r.viewingContextQueryString),name:t.attr("data-name"),id:t.attr("data-id"),isQuiz:t.attr("data-is-quiz")==="true",isYoutube:t.attr("data-is-youtube")==="true"})});t.find(r.launchSelector).on("click",function(e){e.preventDefault();var t=l.overrideIdentityParams(u(this).attr("href"),r.identityParams);window.open(t,"_blank")});e.find("img").on("error",function(e){var t=l.setThumbnailParameters(r.hal.fallbackThumbnailUrl,300,169,"Black");var i=u(this);if(i.attr("src")!==t){i.attr("src",t);i.off("error")}});e.on("focus",function(e){var i=u(this);u(window).keyup(function(e){var t=e.keyCode?e.keyCode:e.which;if(t===9&&i.is(":focus")){i.parent().parent().find(r.gridItemOverlaySelector).addClass("focus")}})});t.find(this.gridItemLaunchSelector).on("focus",function(e){u(this).parent().parent().parent().addClass("focus")});t.find(this.gridItemLaunchSelector).on("blur",function(e){u(this).parent().parent().parent().removeClass("focus")});e.addClass(r.clickRegisteredClass)},loadMore:function(i){if(!this.hasNextPage())return;var r=this;u(i).find(r.loadMoreLoaderSelector).show();var e=this.nextPageUrl;e=l.appendCustomQuery(e,this.identityQueryString);this.nextPageUrl=null;r.hal.get(e,{},function(e){var t=r.parseData(e);u.each(t.items,function(e,t){r.playlist.items.push(t)});r.renderMore(t.items);u(i).find(r.loadMoreLoaderSelector).hide()})},refresh:function(){var t=this;t.filter.search=u(t.searchSelector).val();t.filter.categories=u(t.categoriesSelector).val()==="-1"?undefined:u(t.categoriesSelector).val();u(t.refreshLoaderSelector).show();var e=l.overrideIdentityParams(t.api.playlistUrl,t.identityParams);t.hal.get(e,t.filter,function(e){t.playlist=t.parseData(e);t.renderVideosCount();t.render();u(t.refreshLoaderSelector).hide()})},loadPlayer:function(e){var t="";if(l.insideIframe()||this.forceIframe||e.isYoutube){t=u(this.iframePlayerTemplateSelector).tmpl({name:e.name,pluginUrl:l.overrideIdentityParams(e.pluginUrl,this.identityParams)})}else{var i="embed_"+this.requestId+"_"+e.id;var r=l.overrideParameter(e.javascriptPluginUrl,"embedId",i);r=l.overrideIdentityParams(r,this.identityParams);var n='<script type="text/javascript" src="'+r+'"><\/script>';t=u(this.javascriptPlayerTemplateSelector).tmpl({id:e.id,name:e.name,embedId:i,innerScript:n})}u(this.pluginPlayerSelector).html(t.html())},loadFirstItem:function(){if(!this.playlistLoaded){var e=this;setTimeout(function(){e.loadFirstItem()},500);return}var t=this.playlist.items[0];if(t===undefined||t===null)return;t.pluginUrl=l.setPreviewUrl(t.pluginUrl,this.contentQueryString,this.autoPlayFeaturedContent,this.identityQueryString,this.viewingContextQueryString);t.javascriptPluginUrl=l.setPreviewUrl(t.javascriptPluginUrl,this.contentQueryString,this.autoPlayFeaturedContent,this.identityQueryString,this.viewingContextQueryString);this.loadPlayer(t)},setScrollerHeight:function(){var e=u(this.pluginPlayerBlockSelector).width()*.5625;var t=u(this.headerSelector).height()+26;var i=this.isPlayerInFullWidth()?"calc(100% - "+t+"px)":e-t+"px";u(this.itemsCollectionSelector).css("height",i)},hasNextPage:function(){return this.nextPageUrl!==undefined&&this.nextPageUrl!==null&&this.nextPageUrl!==""},isPlayerInFullWidth:function(){return this.pluginPlayerResponsiveClass==="ev-pl-item-12"}}})(e)})($ev);
//# sourceMappingURL=verticalListWithPlayer.min.js.map