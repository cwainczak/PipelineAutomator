/*! EnsembleVideo - v5.4.0 */

adminUtilitiesInstance={};var adminUtilities=Class.create({confirmDeleteSelector:'[class="confirmDelete"],.confirmDelete',selectAllOnClickElementSelector:'[class="selectAllOnClick"],.selectAllOnClick',confirmInModalWindowOnDeleteContainerID:'confirmInModalWindowOnDeleteContainer',confirmDynamicContentID:'confirmDynamicContent',infoTriggerSelector:'[class="infoTrigger"],.infoTrigger',infoTriggerInputGroupSelector:'[class="infoTriggerGroup"],.infoTriggerGroup',tooltipTriggerSelector:'[class="tooltipTrigger"],.tooltipTrigger',redirectButtonSelector:'input[class="redirectButton"],.redirectButton',refreshPageSelector:'[class="refreshPage"],.refreshPage',refreshPageWithQueryStringSelector:'[class="refreshPageWithQueryString"],.refreshPageWithQueryString',reloadOnEnterSelector:'[class="reloadOnEnter"],.reloadOnEnter',reloadOnClickSelector:'[class="reloadOnClick"],.reloadOnClick',saveButtonSelector:'[class="saveButton"],.saveButton',cancelButtonSelector:'[class="cancelButton"],.cancelButton',videoTabClass:'videoTab',videoTabSelector:'[class="videoTab"],.videoTab',goBackSelector:'[class="goBack"],.goBack',videoTabSelectedClass:'videoTabSelected',setFocusSelector:'[class="setFocus"],.setFocus',adminMenuSelector:'[class="adminMenu"],.adminMenu',hideObserver:'',confirmYesButtonID:'confirmYesButton',confirmNoButtonID:'confirmNoButton',confirmMessage:'Are You Sure?',noneSelected:'Nothing selected',noneResults:'No results match',triggerElement:'',contentStateSelector:'[class="contentState"],.contentState',InstitutionsSelector:'InstitutionsSelect',OrganizationsSelector:'OrganizationsSelect',reSubmitJobSelector:'[class="resubmitJob"],.resubmitJob',btnRecordAction:'[class="btnRecAction"],.btnRecAction',btnRtspLiveAction:'[class="btnRtspLiveAction"],.btnRtspLiveAction',btnRtspCaptureAction:'[class="btnRtspCaptureAction"],.btnRtspCaptureAction',btnProcessingButtonFormat:'processing_',thumbnailImageID:'thumbnailImage_{0}',shouldNotUpdateContentStatusRegEx:new RegExp('ready|failed','ig'),convertingContentStatusRegEx:new RegExp('converting','ig'),failedContentStatusRegEx:new RegExp('failed','ig'),readyContentStatusRegEx:new RegExp('ready','ig'),confirmMessageTemplate:new Template('<p id="confirmMessageText">#{confirmMessageText}</p>'+'<input type="button" value="Yes" id="confirmYesButton">'+'&nbsp;or&nbsp;'+'<input type="button" value="No" id="confirmNoButton">'+'<br />'+'<span id="confirmMessageLoading"><img src="/app/images/waiting.gif" /> Working on it...</span>'),apiUrl:'ApiUrl',hapiUrl:'HapiUrl',initialize:function(){var e=$$('div#statusMessageContainer')[0];this.AdjustPageDim();if($(e)){if($(e).empty())$(e).hide()}if($(this.confirmInModalWindowOnDeleteContainerID)){$(this.confirmInModalWindowOnDeleteContainerID).hide()}$$(this.confirmDeleteSelector).invoke('observe','click',this.ConfirmDelete.bind(this));$$(this.infoTriggerSelector).invoke('observe','click',this.ShowInfo.bind(this));$$(this.infoTriggerInputGroupSelector).invoke('observe','click',this.ShowInfoFromGroup.bind(this));$$(this.redirectButtonSelector).invoke('observe','click',this.RedirectPage.bind(this));$$(this.reloadOnEnterSelector).invoke('observe','keyup',this.ReloadPageOnEnter.bind(this));$$(this.goBackSelector).invoke('observe','click',this.GoBack.bind(this));$$(this.reloadOnClickSelector,this.refreshPageSelector).invoke('observe','click',this.ReloadPageOnClick.bind(this));$$(this.refreshPageWithQueryStringSelector).invoke('observe','click',this.ReloadPageWithQueryStringOnClick.bind(this));$$(this.btnRecordAction).invoke('observe','click',this.LiveStreamRecordAction.bind(this));$$(this.btnRtspLiveAction).invoke('observe','click',this.LiveStreamRtspAction.bind(this));$$(this.btnRtspCaptureAction).invoke('observe','click',this.LiveCaptureRtspAction.bind(this));var t=$$(this.adminMenuSelector);if(t.length>0){t=$$(this.adminMenuSelector)[0];$(t).observe('change',this.RedirectPage.bind(this));var a=location.pathname.gsub(/.*\/(\w+.*)$/,'#{1}').toLowerCase();var n=location.pathname.toLowerCase().indexOf('reports')>=0;for(i=0;i<$(t).options.length;i++){var s=n&&$(t).options[i].value.toLowerCase().include("/reports/");var r=!n&&$(t).options[i].value.toLowerCase().include(a);if(s||r){$(t).selectedIndex=i;break}}}$$(this.videoTabSelector).each(function(e){if($(e).readAttribute('href')!='undefined'){if(location.href.toLowerCase().gsub(/.*\/(\w+\.\w+)\??.*$/,'#{1}')==$(e).readAttribute('href').toLowerCase().gsub(/(.*\/)?(\w+\.\w+)\??.*$/,'#{2}')){$(e).removeClassName(this.videoTabClass);$(e).addClassName(this.videoTabSelectedClass)}else{$(e).removeClassName(this.videoTabSelectedClass);$(e).addClassName(this.videoTabClass)}}}.bind(this));this.ActivateField();this.ObserveSelectAllOnClick();this.SetupContentStateUpdate();this.SetupShortcuts()},SetupContentStateUpdate:function(){if($$(this.contentStateSelector).length>0){$$(this.contentStateSelector).each(function(e){this.UpdateContentState(e)}.bind(this))}},SetupConfirmation:function(e){$(this.confirmDynamicContentID).update(this.confirmMessageTemplate.evaluate({confirmMessageText:e}))},ActivateField:function(){$$(this.setFocusSelector).each(function(e){$(e).activate();throw $break})},ObserveSelectAllOnClick:function(){$$(this.selectAllOnClickElementSelector).invoke('observe','click',function(e){var t=Event.element(e);if($(t)){$(t).select()}})},RedirectPage:function(e){var t=Event.element(e);var a='';if(t.readAttribute('rel')!='undefined'&&t.readAttribute('rel')!=null){a=t.readAttribute('rel')}else if($F(t)!='undefined'){a=$F(t)}if(!a.empty())location.href=a},ReloadPageOnEnter:function(e){var t=Event.element(e);if(e.element().type==='text'&&(e.keyCode==Event.KEY_RETURN||e.keyCode==3)){var a=location.href.gsub(/\?.*/,'')+'?'+$(t).readAttribute('name')+'='+$F(t);location.href=a}},ReloadPageOnClick:function(e){var t=Event.element(e);var a='';if(t.readAttribute('rel')!=undefined&&$(t.readAttribute('rel'))){a=$(t.readAttribute('rel'));location.href=location.href.gsub(/\?.*/,'')+'?'+$(a).readAttribute('name')+'='+$F(a)}else{location.href=location.href.gsub(/\?.*/,'')}Event.stop(e)},ReloadPageWithQueryStringOnClick:function(e){var t=Event.element(e);var a='';var n='';if(t.readAttribute('rel')!=undefined&&$(t.readAttribute('rel'))){a=$(t.readAttribute('rel'));if(location.search!=undefined){n=location.href+'&'+$(a).readAttribute('name')+'='+$F(a)}else{n=location.href+'?'+$(a).readAttribute('name')+'='+$F(a)}}else if(t.readAttribute('strip')!=undefined){var i=t.readAttribute('strip');var s=$H(location.search.toQueryParams());s.unset(i);n=location.href.gsub(/\?.*/,'')+'?'+s.toQueryString()}else{n=location.href}location.href=n;Event.stop(e)},ConfirmDelete:function(e){var t=Event.element(e);var a='';if($(t)){if(t.nodeName!='A')t=t.up('a');a=t.readAttribute('rel')!=null?t.readAttribute('rel'):this.confirmMessage;if(a.empty())return;this.ConfigConfirmModal();this.ConfigConfirmModalCustom(t);if(!a.empty()){if($(this.confirmInModalWindowOnDeleteContainerID)){this.triggerElement=$(t);jQuery('.bodyContent').empty().append(a).append($(this.confirmInModalWindowOnDeleteContainerID).innerHTML);jQuery('#confirmModal').modal();Event.stop(e)}else if(!confirm(a)){Event.stop(e)}}}},ConfigConfirmModal:function(){jQuery('#confirmModal').on('show.bs.modal',function(e){jQuery(this).find('.btn-ok').on('click',function(){adminUtilitiesInstance.submitConfirm();adminUtilitiesInstance.ClearAndHideConfirmModal()});jQuery(this).find('.closeModal').on('click',function(){jQuery('#confirmModal').modal('hide');adminUtilitiesInstance.ClearAndHideConfirmModal()})})},ConfigConfirmModalCustom:function(){},ClearAndHideConfirmModal:function(){jQuery('.bodyContent').empty();jQuery('#confirmModal').modal('hide')},SetupShortcuts:function(){var e=this.GetElement(this.saveButtonSelector);var t=this.GetElement(this.cancelButtonSelector);if($(e)){shortcut.add("Ctrl+S",function(){$(e).click()})}if($(t)){shortcut.add("ESC",function(){$(t).click()})}},submitConfirm:function(e){},ShowInfo:function(e){var t=Event.element(e);var a=$(t.parentNode).select('.info')[0];this.SetAndShowInfoModal(a.outerHTML)},ShowInfoFromGroup:function(e){var t=Event.element(e);var a=$(t).up('.input-group').select('.info')[0];this.SetAndShowInfoModal(a.outerHTML)},SetAndShowInfoModal:function(e){jQuery(".infoBodyContent").empty();jQuery(".infoBodyContent").append(e);jQuery(".infoBodyContent").find('.info').show();jQuery("#infoModal").modal()},GetElement:function(e){return $($$(e)[0])},FindPosY:function(e){var t=0;if(e.offsetParent)while(1){t+=e.offsetTop;if(!e.offsetParent)break;e=e.offsetParent}else if(e.y)t+=e.y;return t},AdjustPageDim:function(){},GetViewportHeight:function(){var e;var t;if(typeof window.innerWidth!='undefined'){e=window.innerWidth;t=window.innerHeight}else if(typeof document.documentElement!='undefined'&&typeof document.documentElement.clientWidth!='undefined'&&document.documentElement.clientWidth!=0){e=document.documentElement.clientWidth;t=document.documentElement.clientHeight}else{e=document.getElementsByTagName('body')[0].clientWidth;t=document.getElementsByTagName('body')[0].clientHeight}return t},ResubmitJob:function(e){var t=Event.element(e);var a=$(t).up().up();var n=a.readAttribute('contentID');app.Old_App_Code.DataAccess.RescheduleContentTranscoding(n,function(e){this.SetContentState(e,a);this.SetupContentStateUpdate()}.bind(this));Event.stop(e)},UpdateContentState:function(i){new PeriodicalExecuter(function(a){var n=i.readAttribute('contentID');app.Old_App_Code.DataAccess.ContentState(n,function(e){if(this.SetContentState(e,i)){var t=e.ReadableStatus;if(this.shouldNotUpdateContentStatusRegEx.match(t)){a.stop();if(!this.failedContentStatusRegEx.match(t)){$(this.thumbnailImageID.replace('{0}',n)).writeAttribute('src',e.ThumbnailImageUrl+'?width=100')}}}}.bind(this))}.bind(this),30)},SetContentState:function(e,t){var a=e.ReadableStatus;var n=e.Message;if(this.readyContentStatusRegEx.match(a)){window.location.reload();return false}t.update(a);t.writeAttribute('title',n);t.writeAttribute('class',e.CssClass);return true},GoBack:function(e){history.go(-1)},LiveStreamRecordAction:function(e){var a=Event.element(e);if($(a)){if(a.nodeName!='A')a=a.up('a');var t='';if(a.readAttribute('streamId')!='undefined'&&a.readAttribute('streamId')!=null){t=a.readAttribute('streamId')}if(t==null||t=='')return;var n=a.up();var i=n.up().up().up();var s=n.select('.btnStopRec')[0];var r=n.select('.btnStartRec')[0];var o=i.select('.item-info')[0];var l=i.select('.item-thumbnail-content')[0];var d=l.select('.liveIcon')[0];var c=o.select('.item-info-state')[0].select('span')[0];var m=o.select('.viewersCount')[0];var u=l.select('.on-air-thumbnail')[0];var f=l.select('.off-air-thumbnail')[0];var v=a.hasClassName('recordInProgress');var h=$(this.hapiUrl).getValue()+"/v1/streams/"+t+"/recording/";var p=n.select('span')[0];h+=v?"stop":"start";var g=this;var C=new Ajax.Request(h,{method:'get',onCreate:function(e){a.addClassName('ev-hidden');p.setStyle({display:'inline-block'})},onSuccess:function(e){p.setStyle({display:'none'});var t=e.responseText.evalJSON();if(t.success){if(t.status==='Streaming'){c.removeClassName('text-red3').addClassName('text-green3').update('Streaming');d.removeClassName('ev-hidden');u.removeClassName('ev-hidden');f.addClassName('ev-hidden');s.addClassName('ev-hidden').removeClassName('recordInProgress');r.removeClassName('ev-hidden').removeClassName('recordInProgress');if(m)m.removeClassName('ev-hidden')}else if(t.status==='Recording'){c.removeClassName('text-green3').addClassName('text-red3').update('Recording');d.removeClassName('ev-hidden');u.removeClassName('ev-hidden');f.addClassName('ev-hidden');r.addClassName('ev-hidden').addClassName('recordInProgress');s.removeClassName('ev-hidden').addClassName('recordInProgress');if(m)m.removeClassName('ev-hidden')}else{c.removeClassName('text-red3').addClassName('text-green3').update('Ready');d.addClassName('ev-hidden');u.addClassName('ev-hidden');f.removeClassName('ev-hidden');s.addClassName('ev-hidden').removeClassName('recordInProgress');r.addClassName('ev-hidden').removeClassName('recordInProgress');if(m)m.addClassName('ev-hidden')}}else{c.removeClassName('text-green3').addClassName('text-red3').update(g.TranslateStreamingStatusMessage(t.message));a.removeClassName('ev-hidden')}},onFailure:function(e){p.setStyle({display:'none'});a.removeClassName('ev-hidden')}.bind(this)})}},LiveStreamRtspAction:function(e){var a=Event.element(e);if($(a)){if(a.nodeName!='A')a=a.up('a');var t='';if(a.readAttribute('streamId')!='undefined'&&a.readAttribute('streamId')!=null){t=a.readAttribute('streamId')}if(t==null||t=='')return;var n=$(this.hapiUrl).getValue()+"/v1/streams/"+t;if(a.hasClassName('btnStartStream')){n+="/streaming/pull/start"}else if(a.hasClassName('btnStopStream')){n+="/streaming/pull/stop"}else if(a.hasClassName('btnStartRec')){n+="/recording/pull/start"}else if(a.hasClassName('btnStopRec')){n+="/recording/pull/stop"}var i=a.up();var s=i.up().up().up();var r=i.select('.btnStartStream')[0];var o=i.select('.btnStopStream')[0];var l=i.select('.btnStartRec')[0];var d=i.select('.btnStopRec')[0];var c=s.select('.item-info')[0];var m=s.select('.item-thumbnail-content')[0];var u=m.select('.liveIcon')[0];var f=c.select('.item-info-state')[0].select('span')[0];var v=c.select('.viewersCount')[0];var h=m.select('.on-air-thumbnail')[0];var p=m.select('.off-air-thumbnail')[0];var g=a.up().select('.processingRecAction')[0];var C=this;var b=new Ajax.Request(n,{method:'get',onCreate:function(e){i.select('a').each(function(e){if(!$(e).hasClassName('ev-hidden')){$(e).addClassName('ev-hidden processing')}});g.setStyle({display:'inline-block'})},onSuccess:function(e){g.setStyle({display:'none'});i.select('a').each(function(e){if($(e).hasClassName('processing')){$(e).removeClassName('processing')}});var t=e.responseText.evalJSON();if(t.success){if(t.status==='Streaming'){f.removeClassName('text-red3').addClassName('text-green3').update('Streaming');u.removeClassName('ev-hidden');h.removeClassName('ev-hidden');p.addClassName('ev-hidden');r.addClassName('ev-hidden');o.removeClassName('ev-hidden');l.removeClassName('ev-hidden');d.addClassName('ev-hidden')}else if(t.status==='Recording'){f.removeClassName('text-green3').addClassName('text-red3').update('Recording');u.removeClassName('ev-hidden');h.removeClassName('ev-hidden');p.addClassName('ev-hidden');r.addClassName('ev-hidden');o.removeClassName('ev-hidden');l.addClassName('ev-hidden');d.removeClassName('ev-hidden')}else{f.removeClassName('text-red3').addClassName('text-green3').update('Ready');u.addClassName('ev-hidden');h.addClassName('ev-hidden');p.removeClassName('ev-hidden');r.removeClassName('ev-hidden');o.addClassName('ev-hidden');d.addClassName('ev-hidden');l.addClassName('ev-hidden');if(v)v.addClassName('ev-hidden')}}else{f.removeClassName('text-green3').addClassName('text-red3').update(C.TranslateStreamingStatusMessage(t.message));$(a).removeClassName('ev-hidden')}},onFailure:function(e){g.setStyle({display:'none'});i.select('a').each(function(e){if($(e).hasClassName('processing')){$(e).removeClassName('processing').removeClassName('ev-hidden')}})}.bind(this)})}},LiveCaptureRtspAction:function(e){var t=Event.element(e);if($(t)){if(t.nodeName!='A')t=t.up('a');var a='';if(t.readAttribute('streamId')!='undefined'&&t.readAttribute('streamId')!=null){a=t.readAttribute('streamId')}if(a==null||a=='')return;var n=$(this.hapiUrl).getValue()+"/v1/streams/"+a;if(t.hasClassName('btnStartStreamAndRec')){n+="/streaming/pull/start?recordStream=true"}else if(t.hasClassName('btnStopStreamAndRec')){n+="/recording/pull/stop?stopStream=true"}var i=t.up();var s=i.up().up().up();var r=i.select('.btnStartStreamAndRec')[0];var o=i.select('.btnStopStreamAndRec')[0];var l=s.select('.item-info')[0];var d=s.select('.item-thumbnail-content')[0];var c=d.select('.liveIcon')[0];var m=l.select('.item-info-state')[0].select('span')[0];var u=l.select('.viewersCount')[0];var f=d.select('.on-air-thumbnail')[0];var v=d.select('.off-air-thumbnail')[0];var h=t.up().select('span')[0];var p=this;var g=new Ajax.Request(n,{method:'get',onCreate:function(e){$(t).addClassName('ev-hidden');h.setStyle({display:'inline-block'})},onSuccess:function(e){h.setStyle({display:'none'});var t=e.responseText.evalJSON();if(t.success){if(t.status==='Recording'){m.removeClassName('text-green3').addClassName('text-red3').update('Recording');if(u)u.removeClassName('ev-hidden');c.removeClassName('ev-hidden');f.removeClassName('ev-hidden');v.addClassName('ev-hidden');r.addClassName('ev-hidden');o.removeClassName('ev-hidden')}else{m.removeClassName('text-red3').addClassName('text-green3').update('Ready');if(u)u.addClassName('ev-hidden');c.addClassName('ev-hidden');f.addClassName('ev-hidden');v.removeClassName('ev-hidden');o.addClassName('ev-hidden');r.removeClassName('ev-hidden')}}else{m.removeClassName('text-green3').addClassName('text-red3').update(p.TranslateStreamingStatusMessage(t.message))}},onFailure:function(e){h.setStyle({display:'none'});$(t).addClassName('ev-hidden')}.bind(this)})}},TranslateStreamingStatusMessage:function(e){if(e==='Failed to retrieve stream info')return'Failed to retrieve stream info';if(e==='Failed to retrieve workflow info')return'Failed to retrieve workflow info';if(e==='Failed to remove stream file')return'Failed to remove stream file';if(e==='Failed to create stream file')return'Failed to create stream file';if(e==='Failed to initiate streaming')return'Failed to initiate streaming';if(e==='Streaming not started')return'Streaming not started';if(e==='Failed to initiate recording')return'Failed to initiate recording';if(e==='Failed to stop recording')return'Failed to stop recording';if(e==='Failed to disconnect stream')return'Failed to disconnect stream';if(e==='Streaming not stopped')return'Streaming not stopped';if(e==='Streaming not started')return'Streaming not started';return e}});document.observe("dom:loaded",function(){adminUtilitiesInstance=new adminUtilities});shortcut={all_shortcuts:{},add:function(d,c,m){var e={type:'keydown',propagate:false,disable_in_input:false,target:document,keycode:false};if(!m)m=e;else{for(var t in e){if(typeof m[t]=='undefined')m[t]=e[t]}}var a=m.target;if(typeof m.target=='string')a=document.getElementById(m.target);var n=this;d=d.toLowerCase();var i=function(e){e=e||window.event;if(m['disable_in_input']){var t;if(e.target)t=e.target;else if(e.srcElement)t=e.srcElement;if(t.nodeType==3)t=t.parentNode;if(t.tagName=='INPUT'||t.tagName=='TEXTAREA')return}if(e.keyCode)code=e.keyCode;else if(e.which)code=e.which;var a=String.fromCharCode(code).toLowerCase();if(code==188)a=",";if(code==190)a=".";var n=d.split("+");var i=0;var s={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":":","'":"\"",",":"<",".":">","/":"?","\\":"|"};var r={esc:27,escape:27,tab:9,space:32,return:13,enter:13,backspace:8,scrolllock:145,scroll_lock:145,scroll:145,capslock:20,caps_lock:20,caps:20,numlock:144,num_lock:144,num:144,pause:19,break:19,insert:45,home:36,delete:46,end:35,pageup:33,page_up:33,pu:33,pagedown:34,page_down:34,pd:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123};var o={shift:{wanted:false,pressed:false},ctrl:{wanted:false,pressed:false},alt:{wanted:false,pressed:false},meta:{wanted:false,pressed:false}};if(e.ctrlKey)o.ctrl.pressed=true;if(e.shiftKey)o.shift.pressed=true;if(e.altKey)o.alt.pressed=true;if(e.metaKey)o.meta.pressed=true;for(var l=0;k=n[l],l<n.length;l++){if(k=='ctrl'||k=='control'){i++;o.ctrl.wanted=true}else if(k=='shift'){i++;o.shift.wanted=true}else if(k=='alt'){i++;o.alt.wanted=true}else if(k=='meta'){i++;o.meta.wanted=true}else if(k.length>1){if(r[k]==code)i++}else if(m['keycode']){if(m['keycode']==code)i++}else{if(a==k)i++;else{if(s[a]&&e.shiftKey){a=s[a];if(a==k)i++}}}}if(i==n.length&&o.ctrl.pressed==o.ctrl.wanted&&o.shift.pressed==o.shift.wanted&&o.alt.pressed==o.alt.wanted&&o.meta.pressed==o.meta.wanted){c(e);if(!m['propagate']){e.cancelBubble=true;e.returnValue=false;if(e.stopPropagation){e.stopPropagation();e.preventDefault()}return false}}};this.all_shortcuts[d]={callback:i,target:a,event:m['type']};if(a.addEventListener)a.addEventListener(m['type'],i,false);else if(a.attachEvent)a.attachEvent('on'+m['type'],i);else a['on'+m['type']]=i},remove:function(e){e=e.toLowerCase();var t=this.all_shortcuts[e];delete this.all_shortcuts[e];if(!t)return;var a=t['event'];var n=t['target'];var i=t['callback'];if(n.detachEvent)n.detachEvent('on'+a,i);else if(n.removeEventListener)n.removeEventListener(a,i,false);else n['on'+a]=false}};
//# sourceMappingURL=utilities.min.js.map