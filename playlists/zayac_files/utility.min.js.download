/*! EnsembleVideo - v5.4.0 */

String.prototype.parseColor=function(){var e='#';if(this.slice(0,4)=='rgb('){var t=this.slice(4,this.length-1).split(',');var i=0;do{e+=parseInt(t[i]).toColorPart()}while(++i<3)}else{if(this.slice(0,1)=='#'){if(this.length==4)for(var i=1;i<4;i++)e+=(this.charAt(i)+this.charAt(i)).toLowerCase();if(this.length==7)e=this.toLowerCase()}}return e.length==7?e:arguments[0]||this};Element.collectTextNodes=function(e){return $A($(e).childNodes).collect(function(e){return e.nodeType==3?e.nodeValue:e.hasChildNodes()?Element.collectTextNodes(e):''}).flatten().join('')};Element.collectTextNodesIgnoreClass=function(e,t){return $A($(e).childNodes).collect(function(e){return e.nodeType==3?e.nodeValue:e.hasChildNodes()&&!Element.hasClassName(e,t)?Element.collectTextNodesIgnoreClass(e,t):''}).flatten().join('')};Element.setContentZoom=function(e,t){e=$(e);e.setStyle({fontSize:t/100+'em'});if(Prototype.Browser.WebKit)window.scrollBy(0,0);return e};Element.getInlineOpacity=function(e){return $(e).style.opacity||''};Element.forceRerendering=function(e){try{e=$(e);var t=document.createTextNode(' ');e.appendChild(t);e.removeChild(t)}catch(e){}};var Effect={_elementDoesNotExistError:{name:'ElementDoesNotExistError',message:'The specified DOM element does not exist, but is required for this effect to operate'},Transitions:{linear:Prototype.K,sinoidal:function(e){return-Math.cos(e*Math.PI)/2+.5},reverse:function(e){return 1-e},flicker:function(e){var e=-Math.cos(e*Math.PI)/4+.75+Math.random()/4;return e>1?1:e},wobble:function(e){return-Math.cos(e*Math.PI*(9*e))/2+.5},pulse:function(e,t){t=t||5;return(e%(1/t)*t).round()==0?e*t*2-(e*t*2).floor():1-(e*t*2-(e*t*2).floor())},spring:function(e){return 1-Math.cos(e*4.5*Math.PI)*Math.exp(-e*6)},none:function(e){return 0},full:function(e){return 1}},DefaultOptions:{duration:1,fps:100,sync:false,from:0,to:1,delay:0,queue:'parallel'},tagifyText:function(i){var s='position:relative';if(Prototype.Browser.IE)s+=';zoom:1';i=$(i);$A(i.childNodes).each(function(t){if(t.nodeType==3){t.nodeValue.toArray().each(function(e){i.insertBefore(new Element('span',{style:s}).update(e==' '?String.fromCharCode(160):e),t)});Element.remove(t)}})},multiple:function(e,i){var t;if((typeof e=='object'||Object.isFunction(e))&&e.length)t=e;else t=$(e).childNodes;var s=Object.extend({speed:.1,delay:0},arguments[2]||{});var n=s.delay;$A(t).each(function(e,t){new i(e,Object.extend(s,{delay:t*s.speed+n}))})},PAIRS:{slide:['SlideDown','SlideUp'],blind:['BlindDown','BlindUp'],appear:['Appear','Fade']},toggle:function(e,t){e=$(e);t=(t||'appear').toLowerCase();var i=Object.extend({queue:{position:'end',scope:e.id||'global',limit:1}},arguments[2]||{});Effect[e.visible()?Effect.PAIRS[t][1]:Effect.PAIRS[t][0]](e,i)}};Effect.DefaultOptions.transition=Effect.Transitions.sinoidal;Effect.ScopedQueue=Class.create(Enumerable,{initialize:function(){this.effects=[];this.interval=null},_each:function(e){this.effects._each(e)},add:function(t){var e=(new Date).getTime();var i=Object.isString(t.options.queue)?t.options.queue:t.options.queue.position;switch(i){case'front':this.effects.findAll(function(e){return e.state=='idle'}).each(function(e){e.startOn+=t.finishOn;e.finishOn+=t.finishOn});break;case'with-last':e=this.effects.pluck('startOn').max()||e;break;case'end':e=this.effects.pluck('finishOn').max()||e;break}t.startOn+=e;t.finishOn+=e;if(!t.options.queue.limit||this.effects.length<t.options.queue.limit)this.effects.push(t);if(!this.interval)this.interval=setInterval(this.loop.bind(this),15)},remove:function(t){this.effects=this.effects.reject(function(e){return e==t});if(this.effects.length==0){clearInterval(this.interval);this.interval=null}},loop:function(){var e=(new Date).getTime();for(var t=0,i=this.effects.length;t<i;t++)this.effects[t]&&this.effects[t].loop(e)}});Effect.Queues={instances:$H(),get:function(e){if(!Object.isString(e))return e;return this.instances.get(e)||this.instances.set(e,new Effect.ScopedQueue)}};Effect.Queue=Effect.Queues.get('global');Effect.Base=Class.create({position:null,start:function(options){function codeForEvent(e,t){return(e[t+'Internal']?'this.options.'+t+'Internal(this);':'')+(e[t]?'this.options.'+t+'(this);':'')}if(options&&options.transition===false)options.transition=Effect.Transitions.linear;this.options=Object.extend(Object.extend({},Effect.DefaultOptions),options||{});this.currentFrame=0;this.state='idle';this.startOn=this.options.delay*1e3;this.finishOn=this.startOn+this.options.duration*1e3;this.fromToDelta=this.options.to-this.options.from;this.totalTime=this.finishOn-this.startOn;this.totalFrames=this.options.fps*this.options.duration;eval('this.render = function(pos){ '+'if (this.state=="idle"){this.state="running";'+codeForEvent(this.options,'beforeSetup')+(this.setup?'this.setup();':'')+codeForEvent(this.options,'afterSetup')+'};if (this.state=="running"){'+'pos=this.options.transition(pos)*'+this.fromToDelta+'+'+this.options.from+';'+'this.position=pos;'+codeForEvent(this.options,'beforeUpdate')+(this.update?'this.update(pos);':'')+codeForEvent(this.options,'afterUpdate')+'}}');this.event('beforeStart');if(!this.options.sync)Effect.Queues.get(Object.isString(this.options.queue)?'global':this.options.queue.scope).add(this)},loop:function(e){if(e>=this.startOn){if(e>=this.finishOn){this.render(1);this.cancel();this.event('beforeFinish');if(this.finish)this.finish();this.event('afterFinish');return}var t=(e-this.startOn)/this.totalTime,i=(t*this.totalFrames).round();if(i>this.currentFrame){this.render(t);this.currentFrame=i}}},cancel:function(){if(!this.options.sync)Effect.Queues.get(Object.isString(this.options.queue)?'global':this.options.queue.scope).remove(this);this.state='finished'},event:function(e){if(this.options[e+'Internal'])this.options[e+'Internal'](this);if(this.options[e])this.options[e](this)},inspect:function(){var e=$H();for(property in this)if(!Object.isFunction(this[property]))e.set(property,this[property]);return'#<Effect:'+e.inspect()+',options:'+$H(this.options).inspect()+'>'}});Effect.Parallel=Class.create(Effect.Base,{initialize:function(e){this.effects=e||[];this.start(arguments[1])},update:function(e){this.effects.invoke('render',e)},finish:function(t){this.effects.each(function(e){e.render(1);e.cancel();e.event('beforeFinish');if(e.finish)e.finish(t);e.event('afterFinish')})}});Effect.Tween=Class.create(Effect.Base,{initialize:function(t,e,i){t=Object.isString(t)?$(t):t;var s=$A(arguments),n=s.last(),o=s.length==5?s[3]:null;this.method=Object.isFunction(n)?n.bind(t):Object.isFunction(t[n])?t[n].bind(t):function(e){t[n]=e};this.start(Object.extend({from:e,to:i},o||{}))},update:function(e){this.method(e)}});Effect.Event=Class.create(Effect.Base,{initialize:function(){this.start(Object.extend({duration:0},arguments[0]||{}))},update:Prototype.emptyFunction});Effect.Opacity=Class.create(Effect.Base,{initialize:function(e){this.element=$(e);if(!this.element)throw Effect._elementDoesNotExistError;if(Prototype.Browser.IE&&!this.element.currentStyle.hasLayout)this.element.setStyle({zoom:1});var t=Object.extend({from:this.element.getOpacity()||0,to:1},arguments[1]||{});this.start(t)},update:function(e){this.element.setOpacity(e)}});Effect.Move=Class.create(Effect.Base,{initialize:function(e){this.element=$(e);if(!this.element)throw Effect._elementDoesNotExistError;var t=Object.extend({x:0,y:0,mode:'relative'},arguments[1]||{});this.start(t)},setup:function(){this.element.makePositioned();this.originalLeft=parseFloat(this.element.getStyle('left')||'0');this.originalTop=parseFloat(this.element.getStyle('top')||'0');if(this.options.mode=='absolute'){this.options.x=this.options.x-this.originalLeft;this.options.y=this.options.y-this.originalTop}},update:function(e){this.element.setStyle({left:(this.options.x*e+this.originalLeft).round()+'px',top:(this.options.y*e+this.originalTop).round()+'px'})}});Effect.MoveBy=function(e,t,i){return new Effect.Move(e,Object.extend({x:i,y:t},arguments[3]||{}))};Effect.Scale=Class.create(Effect.Base,{initialize:function(e,t){this.element=$(e);if(!this.element)throw Effect._elementDoesNotExistError;var i=Object.extend({scaleX:true,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:'box',scaleFrom:100,scaleTo:t},arguments[2]||{});this.start(i)},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||false;this.elementPositioning=this.element.getStyle('position');this.originalStyle={};['top','left','width','height','fontSize'].each(function(e){this.originalStyle[e]=this.element.style[e]}.bind(this));this.originalTop=this.element.offsetTop;this.originalLeft=this.element.offsetLeft;var t=this.element.getStyle('font-size')||'100%';['em','px','%','pt'].each(function(e){if(t.indexOf(e)>0){this.fontSize=parseFloat(t);this.fontSizeType=e}}.bind(this));this.factor=(this.options.scaleTo-this.options.scaleFrom)/100;this.dims=null;if(this.options.scaleMode=='box')this.dims=[this.element.offsetHeight,this.element.offsetWidth];if(/^content/.test(this.options.scaleMode))this.dims=[this.element.scrollHeight,this.element.scrollWidth];if(!this.dims)this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth]},update:function(e){var t=this.options.scaleFrom/100+this.factor*e;if(this.options.scaleContent&&this.fontSize)this.element.setStyle({fontSize:this.fontSize*t+this.fontSizeType});this.setDimensions(this.dims[0]*t,this.dims[1]*t)},finish:function(e){if(this.restoreAfterFinish)this.element.setStyle(this.originalStyle)},setDimensions:function(e,t){var i={};if(this.options.scaleX)i.width=t.round()+'px';if(this.options.scaleY)i.height=e.round()+'px';if(this.options.scaleFromCenter){var s=(e-this.dims[0])/2;var n=(t-this.dims[1])/2;if(this.elementPositioning=='absolute'){if(this.options.scaleY)i.top=this.originalTop-s+'px';if(this.options.scaleX)i.left=this.originalLeft-n+'px'}else{if(this.options.scaleY)i.top=-s+'px';if(this.options.scaleX)i.left=-n+'px'}}this.element.setStyle(i)}});Effect.Highlight=Class.create(Effect.Base,{initialize:function(e){this.element=$(e);if(!this.element)throw Effect._elementDoesNotExistError;var t=Object.extend({startcolor:'#ffff99'},arguments[1]||{});this.start(t)},setup:function(){if(this.element.getStyle('display')=='none'){this.cancel();return}this.oldStyle={};if(!this.options.keepBackgroundImage){this.oldStyle.backgroundImage=this.element.getStyle('background-image');this.element.setStyle({backgroundImage:'none'})}if(!this.options.endcolor)this.options.endcolor=this.element.getStyle('background-color').parseColor('#ffffff');if(!this.options.restorecolor)this.options.restorecolor=this.element.getStyle('background-color');this._base=$R(0,2).map(function(e){return parseInt(this.options.startcolor.slice(e*2+1,e*2+3),16)}.bind(this));this._delta=$R(0,2).map(function(e){return parseInt(this.options.endcolor.slice(e*2+1,e*2+3),16)-this._base[e]}.bind(this))},update:function(s){this.element.setStyle({backgroundColor:$R(0,2).inject('#',function(e,t,i){return e+(this._base[i]+this._delta[i]*s).round().toColorPart()}.bind(this))})},finish:function(){this.element.setStyle(Object.extend(this.oldStyle,{backgroundColor:this.options.restorecolor}))}});Effect.ScrollTo=function(e){var t=arguments[1]||{},i=document.viewport.getScrollOffsets(),s=$(e).cumulativeOffset(),n=(window.height||document.body.scrollHeight)-document.viewport.getHeight();if(t.offset)s[1]+=t.offset;return new Effect.Tween(null,i.top,s[1]>n?n:s[1],t,function(e){scrollTo(i.left,e.round())})};Effect.Fade=function(e){e=$(e);var t=e.getInlineOpacity();var i=Object.extend({from:e.getOpacity()||1,to:0,afterFinishInternal:function(e){if(e.options.to!=0)return;e.element.hide().setStyle({opacity:t})}},arguments[1]||{});return new Effect.Opacity(e,i)};Effect.Appear=function(e){e=$(e);var t=Object.extend({from:e.getStyle('display')=='none'?0:e.getOpacity()||0,to:1,afterFinishInternal:function(e){e.element.forceRerendering()},beforeSetup:function(e){e.element.setOpacity(e.options.from).show()}},arguments[1]||{});return new Effect.Opacity(e,t)};Effect.Puff=function(e){e=$(e);var t={opacity:e.getInlineOpacity(),position:e.getStyle('position'),top:e.style.top,left:e.style.left,width:e.style.width,height:e.style.height};return new Effect.Parallel([new Effect.Scale(e,200,{sync:true,scaleFromCenter:true,scaleContent:true,restoreAfterFinish:true}),new Effect.Opacity(e,{sync:true,to:0})],Object.extend({duration:1,beforeSetupInternal:function(e){Position.absolutize(e.effects[0].element)},afterFinishInternal:function(e){e.effects[0].element.hide().setStyle(t)}},arguments[1]||{}))};Effect.BlindUp=function(e){e=$(e);e.makeClipping();return new Effect.Scale(e,0,Object.extend({scaleContent:false,scaleX:false,restoreAfterFinish:true,afterFinishInternal:function(e){e.element.hide().undoClipping()}},arguments[1]||{}))};Effect.BlindDown=function(e){e=$(e);var t=e.getDimensions();return new Effect.Scale(e,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:0,scaleMode:{originalHeight:t.height,originalWidth:t.width},restoreAfterFinish:true,afterSetup:function(e){e.element.makeClipping().setStyle({height:'0px'}).show()},afterFinishInternal:function(e){e.element.undoClipping()}},arguments[1]||{}))};Effect.SwitchOff=function(e){e=$(e);var t=e.getInlineOpacity();return new Effect.Appear(e,Object.extend({duration:.4,from:0,transition:Effect.Transitions.flicker,afterFinishInternal:function(e){new Effect.Scale(e.element,1,{duration:.3,scaleFromCenter:true,scaleX:false,scaleContent:false,restoreAfterFinish:true,beforeSetup:function(e){e.element.makePositioned().makeClipping()},afterFinishInternal:function(e){e.element.hide().undoClipping().undoPositioned().setStyle({opacity:t})}})}},arguments[1]||{}))};Effect.DropOut=function(e){e=$(e);var t={top:e.getStyle('top'),left:e.getStyle('left'),opacity:e.getInlineOpacity()};return new Effect.Parallel([new Effect.Move(e,{x:0,y:100,sync:true}),new Effect.Opacity(e,{sync:true,to:0})],Object.extend({duration:.5,beforeSetup:function(e){e.effects[0].element.makePositioned()},afterFinishInternal:function(e){e.effects[0].element.hide().undoPositioned().setStyle(t)}},arguments[1]||{}))};Effect.Shake=function(e){e=$(e);var t=Object.extend({distance:20,duration:.5},arguments[1]||{});var i=parseFloat(t.distance);var s=parseFloat(t.duration)/10;var n={top:e.getStyle('top'),left:e.getStyle('left')};return new Effect.Move(e,{x:i,y:0,duration:s,afterFinishInternal:function(e){new Effect.Move(e.element,{x:-i*2,y:0,duration:s*2,afterFinishInternal:function(e){new Effect.Move(e.element,{x:i*2,y:0,duration:s*2,afterFinishInternal:function(e){new Effect.Move(e.element,{x:-i*2,y:0,duration:s*2,afterFinishInternal:function(e){new Effect.Move(e.element,{x:i*2,y:0,duration:s*2,afterFinishInternal:function(e){new Effect.Move(e.element,{x:-i,y:0,duration:s,afterFinishInternal:function(e){e.element.undoPositioned().setStyle(n)}})}})}})}})}})}})};Effect.SlideDown=function(e){e=$(e).cleanWhitespace();var t=e.down().getStyle('bottom');var i=e.getDimensions();return new Effect.Scale(e,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:window.opera?0:1,scaleMode:{originalHeight:i.height,originalWidth:i.width},restoreAfterFinish:true,afterSetup:function(e){e.element.makePositioned();e.element.down().makePositioned();if(window.opera)e.element.setStyle({top:''});e.element.makeClipping().setStyle({height:'0px'}).show()},afterUpdateInternal:function(e){e.element.down().setStyle({bottom:e.dims[0]-e.element.clientHeight+'px'})},afterFinishInternal:function(e){e.element.undoClipping().undoPositioned();e.element.down().undoPositioned().setStyle({bottom:t})}},arguments[1]||{}))};Effect.SlideUp=function(e){e=$(e).cleanWhitespace();var t=e.down().getStyle('bottom');var i=e.getDimensions();return new Effect.Scale(e,window.opera?0:1,Object.extend({scaleContent:false,scaleX:false,scaleMode:'box',scaleFrom:100,scaleMode:{originalHeight:i.height,originalWidth:i.width},restoreAfterFinish:true,afterSetup:function(e){e.element.makePositioned();e.element.down().makePositioned();if(window.opera)e.element.setStyle({top:''});e.element.makeClipping().show()},afterUpdateInternal:function(e){e.element.down().setStyle({bottom:e.dims[0]-e.element.clientHeight+'px'})},afterFinishInternal:function(e){e.element.hide().undoClipping().undoPositioned();e.element.down().undoPositioned().setStyle({bottom:t})}},arguments[1]||{}))};Effect.Squish=function(e){return new Effect.Scale(e,window.opera?1:0,{restoreAfterFinish:true,beforeSetup:function(e){e.element.makeClipping()},afterFinishInternal:function(e){e.element.hide().undoClipping()}})};Effect.Grow=function(e){e=$(e);var t=Object.extend({direction:'center',moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.full},arguments[1]||{});var i={top:e.style.top,left:e.style.left,height:e.style.height,width:e.style.width,opacity:e.getInlineOpacity()};var s=e.getDimensions();var n,o;var r,a;switch(t.direction){case'top-left':n=o=r=a=0;break;case'top-right':n=s.width;o=a=0;r=-s.width;break;case'bottom-left':n=r=0;o=s.height;a=-s.height;break;case'bottom-right':n=s.width;o=s.height;r=-s.width;a=-s.height;break;case'center':n=s.width/2;o=s.height/2;r=-s.width/2;a=-s.height/2;break}return new Effect.Move(e,{x:n,y:o,duration:.01,beforeSetup:function(e){e.element.hide().makeClipping().makePositioned()},afterFinishInternal:function(e){new Effect.Parallel([new Effect.Opacity(e.element,{sync:true,to:1,from:0,transition:t.opacityTransition}),new Effect.Move(e.element,{x:r,y:a,sync:true,transition:t.moveTransition}),new Effect.Scale(e.element,100,{scaleMode:{originalHeight:s.height,originalWidth:s.width},sync:true,scaleFrom:window.opera?1:0,transition:t.scaleTransition,restoreAfterFinish:true})],Object.extend({beforeSetup:function(e){e.effects[0].element.setStyle({height:'0px'}).show()},afterFinishInternal:function(e){e.effects[0].element.undoClipping().undoPositioned().setStyle(i)}},t))}})};Effect.Shrink=function(e){e=$(e);var t=Object.extend({direction:'center',moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.none},arguments[1]||{});var i={top:e.style.top,left:e.style.left,height:e.style.height,width:e.style.width,opacity:e.getInlineOpacity()};var s=e.getDimensions();var n,o;switch(t.direction){case'top-left':n=o=0;break;case'top-right':n=s.width;o=0;break;case'bottom-left':n=0;o=s.height;break;case'bottom-right':n=s.width;o=s.height;break;case'center':n=s.width/2;o=s.height/2;break}return new Effect.Parallel([new Effect.Opacity(e,{sync:true,to:0,from:1,transition:t.opacityTransition}),new Effect.Scale(e,window.opera?1:0,{sync:true,transition:t.scaleTransition,restoreAfterFinish:true}),new Effect.Move(e,{x:n,y:o,sync:true,transition:t.moveTransition})],Object.extend({beforeStartInternal:function(e){e.effects[0].element.makePositioned().makeClipping()},afterFinishInternal:function(e){e.effects[0].element.hide().undoClipping().undoPositioned().setStyle(i)}},t))};Effect.Pulsate=function(e){e=$(e);var t=arguments[1]||{};var i=e.getInlineOpacity();var s=t.transition||Effect.Transitions.sinoidal;var n=function(e){return s(1-Effect.Transitions.pulse(e,t.pulses))};n.bind(s);return new Effect.Opacity(e,Object.extend(Object.extend({duration:2,from:0,afterFinishInternal:function(e){e.element.setStyle({opacity:i})}},t),{transition:n}))};Effect.Fold=function(t){t=$(t);var i={top:t.style.top,left:t.style.left,width:t.style.width,height:t.style.height};t.makeClipping();return new Effect.Scale(t,5,Object.extend({scaleContent:false,scaleX:false,afterFinishInternal:function(e){new Effect.Scale(t,1,{scaleContent:false,scaleY:false,afterFinishInternal:function(e){e.element.hide().undoClipping().setStyle(i)}})}},arguments[1]||{}))};Effect.Morph=Class.create(Effect.Base,{initialize:function(e){this.element=$(e);if(!this.element)throw Effect._elementDoesNotExistError;var t=Object.extend({style:{}},arguments[1]||{});if(!Object.isString(t.style))this.style=$H(t.style);else{if(t.style.include(':'))this.style=t.style.parseStyle();else{this.element.addClassName(t.style);this.style=$H(this.element.getStyles());this.element.removeClassName(t.style);var i=this.element.getStyles();this.style=this.style.reject(function(e){return e.value==i[e.key]});t.afterFinishInternal=function(t){t.element.addClassName(t.options.style);t.transforms.each(function(e){t.element.style[e.style]=''})}}}this.start(t)},setup:function(){function r(t){if(!t||['rgba(0, 0, 0, 0)','transparent'].include(t))t='#ffffff';t=t.parseColor();return $R(0,2).map(function(e){return parseInt(t.slice(e*2+1,e*2+3),16)})}this.transforms=this.style.map(function(e){var t=e[0],i=e[1],s=null;if(i.parseColor('#zzzzzz')!='#zzzzzz'){i=i.parseColor();s='color'}else if(t=='opacity'){i=parseFloat(i);if(Prototype.Browser.IE&&!this.element.currentStyle.hasLayout)this.element.setStyle({zoom:1})}else if(Element.CSS_LENGTH.test(i)){var n=i.match(/^([\+\-]?[0-9\.]+)(.*)$/);i=parseFloat(n[1]);s=n.length==3?n[2]:null}var o=this.element.getStyle(t);return{style:t.camelize(),originalValue:s=='color'?r(o):parseFloat(o||0),targetValue:s=='color'?r(i):i,unit:s}}.bind(this)).reject(function(e){return e.originalValue==e.targetValue||e.unit!='color'&&(isNaN(e.originalValue)||isNaN(e.targetValue))})},update:function(e){var t={},i,s=this.transforms.length;while(s--)t[(i=this.transforms[s]).style]=i.unit=='color'?'#'+Math.round(i.originalValue[0]+(i.targetValue[0]-i.originalValue[0])*e).toColorPart()+Math.round(i.originalValue[1]+(i.targetValue[1]-i.originalValue[1])*e).toColorPart()+Math.round(i.originalValue[2]+(i.targetValue[2]-i.originalValue[2])*e).toColorPart():(i.originalValue+(i.targetValue-i.originalValue)*e).toFixed(3)+(i.unit===null?'':i.unit);this.element.setStyle(t,true)}});Effect.Transform=Class.create({initialize:function(e){this.tracks=[];this.options=arguments[1]||{};this.addTracks(e)},addTracks:function(e){e.each(function(e){e=$H(e);var t=e.values().first();this.tracks.push($H({ids:e.keys().first(),effect:Effect.Morph,options:{style:t}}))}.bind(this));return this},play:function(){return new Effect.Parallel(this.tracks.map(function(e){var t=e.get('ids'),i=e.get('effect'),s=e.get('options');var n=[$(t)||$$(t)].flatten();return n.map(function(e){return new i(e,Object.extend({sync:true},s))})}).flatten(),this.options)}});Element.CSS_PROPERTIES=$w('backgroundColor backgroundPosition borderBottomColor borderBottomStyle '+'borderBottomWidth borderLeftColor borderLeftStyle borderLeftWidth '+'borderRightColor borderRightStyle borderRightWidth borderSpacing '+'borderTopColor borderTopStyle borderTopWidth bottom clip color '+'fontSize fontWeight height left letterSpacing lineHeight '+'marginBottom marginLeft marginRight marginTop markerOffset maxHeight '+'maxWidth minHeight minWidth opacity outlineColor outlineOffset '+'outlineWidth paddingBottom paddingLeft paddingRight paddingTop '+'right textIndent top width wordSpacing zIndex');Element.CSS_LENGTH=/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/;String.__parseStyleElement=document.createElement('div');String.prototype.parseStyle=function(){var t,i=$H();if(Prototype.Browser.WebKit)t=new Element('div',{style:this}).style;else{String.__parseStyleElement.innerHTML='<div style="'+this+'"></div>';t=String.__parseStyleElement.childNodes[0].style}Element.CSS_PROPERTIES.each(function(e){if(t[e])i.set(e,t[e])});if(Prototype.Browser.IE&&this.include('opacity'))i.set('opacity',this.match(/opacity:\s*((?:0|1)?(?:\.\d*)?)/)[1]);return i};if(document.defaultView&&document.defaultView.getComputedStyle){Element.getStyles=function(e){var i=document.defaultView.getComputedStyle($(e),null);return Element.CSS_PROPERTIES.inject({},function(e,t){e[t]=i[t];return e})}}else{Element.getStyles=function(e){e=$(e);var i=e.currentStyle,t;t=Element.CSS_PROPERTIES.inject({},function(e,t){e[t]=i[t];return e});if(!t.opacity)t.opacity=e.getOpacity();return t}}Effect.Methods={morph:function(e,t){e=$(e);new Effect.Morph(e,Object.extend({style:t},arguments[2]||{}));return e},visualEffect:function(e,t,i){e=$(e);var s=t.dasherize().camelize(),n=s.charAt(0).toUpperCase()+s.substring(1);new Effect[n](e,i);return e},highlight:function(e,t){e=$(e);new Effect.Highlight(e,t);return e}};$w('fade appear grow shrink fold blindUp blindDown slideUp slideDown '+'pulsate shake puff squish switchOff dropOut').each(function(i){Effect.Methods[i]=function(e,t){e=$(e);Effect[i.charAt(0).toUpperCase()+i.substring(1)](e,t);return e}});$w('getInlineOpacity forceRerendering setContentZoom collectTextNodes collectTextNodesIgnoreClass getStyles').each(function(e){Effect.Methods[e]=Element[e]});Element.addMethods(Effect.Methods);var Builder={NODEMAP:{AREA:'map',CAPTION:'table',COL:'table',COLGROUP:'table',LEGEND:'fieldset',OPTGROUP:'select',OPTION:'select',PARAM:'object',TBODY:'table',TD:'table',TFOOT:'table',TH:'table',THEAD:'table',TR:'table'},node:function(e){e=e.toUpperCase();var t=this.NODEMAP[e]||'div';var i=document.createElement(t);try{i.innerHTML="<"+e+"></"+e+">"}catch(e){}var s=i.firstChild||null;if(s&&s.tagName.toUpperCase()!=e)s=s.getElementsByTagName(e)[0];if(!s)s=document.createElement(e);if(!s)return;if(arguments[1])if(this._isStringOrNumber(arguments[1])||arguments[1]instanceof Array||arguments[1].tagName){this._children(s,arguments[1])}else{var n=this._attributes(arguments[1]);if(n.length){try{i.innerHTML="<"+e+" "+n+"></"+e+">"}catch(e){}s=i.firstChild||null;if(!s){s=document.createElement(e);for(attr in arguments[1])s[attr=='class'?'className':attr]=arguments[1][attr]}if(s.tagName.toUpperCase()!=e)s=i.getElementsByTagName(e)[0]}}if(arguments[2])this._children(s,arguments[2]);return s},_text:function(e){return document.createTextNode(e)},ATTR_MAP:{className:'class',htmlFor:'for'},_attributes:function(e){var t=[];for(attribute in e)t.push((attribute in this.ATTR_MAP?this.ATTR_MAP[attribute]:attribute)+'="'+e[attribute].toString().escapeHTML().gsub(/"/,'&quot;')+'"');return t.join(" ")},_children:function(t,e){if(e.tagName){t.appendChild(e);return}if(typeof e=='object'){e.flatten().each(function(e){if(typeof e=='object')t.appendChild(e);else if(Builder._isStringOrNumber(e))t.appendChild(Builder._text(e))})}else if(Builder._isStringOrNumber(e))t.appendChild(Builder._text(e))},_isStringOrNumber:function(e){return typeof e=='string'||typeof e=='number'},build:function(e){var t=this.node('div');$(t).update(e.strip());return t.down()},dump:function(t){if(typeof t!='object'&&typeof t!='function')t=window;var e=("A ABBR ACRONYM ADDRESS APPLET AREA B BASE BASEFONT BDO BIG BLOCKQUOTE BODY "+"BR BUTTON CAPTION CENTER CITE CODE COL COLGROUP DD DEL DFN DIR DIV DL DT EM FIELDSET "+"FONT FORM FRAME FRAMESET H1 H2 H3 H4 H5 H6 HEAD HR HTML I IFRAME IMG INPUT INS ISINDEX "+"KBD LABEL LEGEND LI LINK MAP MENU META NOFRAMES NOSCRIPT OBJECT OL OPTGROUP OPTION P "+"PARAM PRE Q S SAMP SCRIPT SELECT SMALL SPAN STRIKE STRONG STYLE SUB SUP TABLE TBODY TD "+"TEXTAREA TFOOT TH THEAD TITLE TR TT U UL VAR").split(/\s+/);e.each(function(e){t[e]=function(){return Builder.node.apply(Builder,[e].concat($A(arguments)))}})}};if(!window.Modalbox)var Modalbox=new Object;Modalbox.Methods={overrideAlert:false,focusableElements:new Array,currFocused:0,initialized:false,active:true,options:{title:"ModalBox Window",overlayClose:true,width:500,height:90,overlayOpacity:.65,overlayDuration:.25,slideDownDuration:.2,slideUpDuration:.2,resizeDuration:.25,inactiveFade:true,transitions:true,loadingString:"Please wait. Loading...",closeString:"Close Window",closeValue:"&times;",params:{},method:'get',autoFocusing:true,iFrame:false,aspnet:false},_options:new Object,setOptions:function(e){Object.extend(this.options,e||{})},_init:function(e){Object.extend(this._options,this.options);this.setOptions(e);this.MBoverlay=new Element("div",{id:"MB_overlay",opacity:"0"});this.MBwindow=new Element("div",{id:"MB_window",style:"display: none"}).update(this.MBframe=new Element("div",{id:"MB_frame"}).update(this.MBheader=new Element("div",{id:"MB_header"}).update(this.MBcaption=new Element("div",{id:"MB_caption"}))));this.MBclose=new Element("a",{id:"MB_close",title:this.options.closeString,href:"#"}).update("<span>"+this.options.closeValue+"</span>");this.MBheader.insert({bottom:this.MBclose});if(!this.options.iFrame){this.MBcontent=new Element("div",{id:"MB_content"}).update(this.MBloading=new Element("div",{id:"MB_loading"}).update(this.options.loadingString))}else{this.MBcontent=new Element("iframe",{id:'MB_content',frameborder:'0'})}this.MBframe.insert({bottom:this.MBcontent});var t=this.options.aspnet?$(document.body).down('form'):$(document.body);t.insert({top:this.MBwindow});t.insert({top:this.MBoverlay});this.initScrollX=window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft;this.initScrollY=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop;this.hideObserver=this._hide.bindAsEventListener(this);this.kbdObserver=this._kbdHandler.bindAsEventListener(this);this._initObservers();this.initialized=true},show:function(e,t){if(!this.initialized)this._init(t);this.content=e;this.setOptions(t);if(this.options.title)$(this.MBcaption).update(this.options.title);else{$(this.MBheader).hide();$(this.MBcaption).hide()}if(this.MBwindow.style.display=="none"){this._appear();this.event("onShow")}else{this._update();this.event("onUpdate")}},hide:function(e){if(this.initialized){if(e&&typeof e.element!='function')Object.extend(this.options,e);this.event("beforeHide");if(this.options.transitions)Effect.SlideUp(this.MBwindow,{duration:this.options.slideUpDuration,transition:Effect.Transitions.sinoidal,afterFinish:this._deinit.bind(this)});else{$(this.MBwindow).hide();this._deinit()}}else throw"Modalbox is not initialized."},_hide:function(e){e.stop();if(e.element().id=='MB_overlay'&&!this.options.overlayClose)return false;this.hide()},alert:function(e){var t='<div class="MB_alert"><p>'+e+'</p><input type="button" onclick="Modalbox.hide()" value="OK" /></div>';Modalbox.show(t,{title:'Alert: '+document.title,width:300})},_appear:function(){if(Prototype.Browser.IE&&!navigator.appVersion.match(/\b7.0\b/)){window.scrollTo(0,0);this._prepareIE("100%","hidden")}this._setWidth();this._setPosition();if(this.options.transitions){$(this.MBoverlay).setStyle({opacity:0});var e=new Effect.Fade(this.MBoverlay,{from:0,to:this.options.overlayOpacity,duration:this.options.overlayDuration,afterFinish:function(){var e=new Effect.SlideDown(this.MBwindow,{duration:this.options.slideDownDuration,transition:Effect.Transitions.sinoidal,afterFinish:function(){this._setPosition();this.loadContent()}.bind(this)})}.bind(this)})}else{$(this.MBoverlay).setStyle({opacity:this.options.overlayOpacity});$(this.MBwindow).show();this._setPosition();this.loadContent()}this._setWidthAndPosition=this._setWidthAndPosition.bindAsEventListener(this);Event.observe(window,"resize",this._setWidthAndPosition)},resize:function(e,t,i){var s=$(this.MBwindow).getHeight();var n=$(this.MBwindow).getWidth();var o=$(this.MBheader).getHeight();var r=$(this.MBcontent).getHeight();var a=s-o+t<r?r+o-s:t;if(i)this.setOptions(i);if(this.options.transitions){var l=new Effect.ScaleBy(this.MBwindow,e,a,{duration:this.options.resizeDuration,afterFinish:function(){this.event("_afterResize");this.event("afterResize")}.bind(this)})}else{this.MBwindow.setStyle({width:n+e+"px",height:s+a+"px"});setTimeout(function(){this.event("_afterResize");this.event("afterResize")}.bind(this),1)}},resizeToContent:function(e){var t=this.options.height-this.MBwindow.offsetHeight;if(t!=0){if(e)this.setOptions(e);Modalbox.resize(0,t)}},resizeToInclude:function(e,t){var i=$(e);var s=i.getHeight()+parseInt(i.getStyle('margin-top'))+parseInt(i.getStyle('margin-bottom'))+parseInt(i.getStyle('border-top-width'))+parseInt(i.getStyle('border-bottom-width'));if(s>0){if(t)this.setOptions(t);Modalbox.resize(0,s)}},_update:function(){$(this.MBcontent).update('');this.MBcontent.appendChild(this.MBloading);$(this.MBloading).update(this.options.loadingString);this.currentDims=[this.MBwindow.offsetWidth,this.MBwindow.offsetHeight];Modalbox.resize(this.options.width-this.currentDims[0],this.options.height-this.currentDims[1],{_afterResize:this._loadAfterResize.bind(this)})},loadContent:function(){if(this.event("beforeLoad")!=false){if(typeof this.content=='string'){var htmlRegExp=new RegExp(/<\/?[^>]+>/gi);if(htmlRegExp.test(this.content)){this._insertContent(this.content.stripScripts());this._putContent(function(){this.content.extractScripts().map(function(script){return eval(script.replace("\x3c!--","").replace("// --\x3e",""))}.bind(window))}.bind(this))}else if(this.options.iFrame){this.MBcontent.src=this.content;this.MBcontent.frameboder=0;this.MBcontent.setStyle({border:0,width:this.options.width-20+"px",height:this.options.height-50+"px"})}else{var request=new Ajax.Request(this.content,{method:this.options.method.toLowerCase(),parameters:this.options.params,onSuccess:function(transport){var response=new String(transport.responseText);this.response=response;this._insertContent(transport.responseText.stripScripts());this._putContent(function(){response.extractScripts().map(function(script){return eval(script.replace("\x3c!--","").replace("// --\x3e",""))}.bind(window))})}.bind(this),onException:function(e,t){Modalbox.hide();throw'Modalbox Loading Error: '+t}})}}else if(typeof this.content=='object'){this._insertContent(this.content);this._putContent()}else{Modalbox.hide();throw'Modalbox Parameters Error: Please specify correct URL or HTML element (plain HTML or object)'}}},_insertContent:function(e){$(this.MBcontent).hide().update("");if(typeof e=='string'){setTimeout(function(){this.MBcontent.update(e)}.bind(this),1)}else if(typeof e=='object'){var t=e.cloneNode(true);if(e.id)e.id="MB_"+e.id;$(e).select('*[id]').each(function(e){e.id="MB_"+e.id});this.MBcontent.appendChild(t);this.MBcontent.down().show();if(Prototype.Browser.IE)$$("#MB_content select").invoke('setStyle',{visibility:''})}},_putContent:function(e){if(this.options.height==this._options.height){setTimeout(function(){Modalbox.resize(0,$(this.MBcontent).getHeight()-$(this.MBwindow).getHeight()+$(this.MBheader).getHeight(),{afterResize:function(){this.MBcontent.show().makePositioned();this.focusableElements=this._findFocusableElements();this._setFocus();setTimeout(function(){if(e!=undefined)e();this.event("afterLoad")}.bind(this),1)}.bind(this)})}.bind(this),1)}else{this._setWidth();this.MBcontent.setStyle({overflow:'auto',height:$(this.MBwindow).getHeight()-$(this.MBheader).getHeight()-13+'px'});this.MBcontent.show();this.focusableElements=this._findFocusableElements();this._setFocus();setTimeout(function(){if(e!=undefined)e();this.event("afterLoad")}.bind(this),1)}},activate:function(e){this.setOptions(e);this.active=true;$(this.MBclose).observe("click",this.hideObserver);if(this.options.overlayClose)$(this.MBoverlay).observe("click",this.hideObserver);$(this.MBclose).show();if(this.options.transitions&&this.options.inactiveFade)new Effect.Appear(this.MBwindow,{duration:this.options.slideUpDuration})},deactivate:function(e){this.setOptions(e);this.active=false;$(this.MBclose).stopObserving("click",this.hideObserver);if(this.options.overlayClose)$(this.MBoverlay).stopObserving("click",this.hideObserver);$(this.MBclose).hide();if(this.options.transitions&&this.options.inactiveFade)new Effect.Fade(this.MBwindow,{duration:this.options.slideUpDuration,to:.75})},_initObservers:function(){$(this.MBclose).observe("click",this.hideObserver);if(this.options.overlayClose)$(this.MBoverlay).observe("click",this.hideObserver);if(Prototype.Browser.IE)Event.observe(document,"keydown",this.kbdObserver);else Event.observe(document,"keypress",this.kbdObserver)},_removeObservers:function(){$(this.MBclose).stopObserving("click",this.hideObserver);if(this.options.overlayClose)$(this.MBoverlay).stopObserving("click",this.hideObserver);if(Prototype.Browser.IE)Event.stopObserving(document,"keydown",this.kbdObserver);else Event.stopObserving(document,"keypress",this.kbdObserver)},_loadAfterResize:function(){this._setWidth();this._setPosition();this.loadContent()},_setFocus:function(){if(this.focusableElements.length>0&&this.options.autoFocusing==true){var e=this.focusableElements.find(function(e){return e.tabIndex==1})||this.focusableElements.first();this.currFocused=this.focusableElements.toArray().indexOf(e);e.focus()}else if($(this.MBclose).visible())$(this.MBclose).focus()},_findFocusableElements:function(){if(this.options.autoFocusing==true)this.MBcontent.select('input:not([type~=hidden]), select, textarea, button, a[href]').invoke('addClassName','MB_focusable');return this.MBcontent.select('.MB_focusable')},_kbdHandler:function(e){var t=e.element();switch(e.keyCode){case Event.KEY_TAB:e.stop();if(t!=this.focusableElements[this.currFocused])this.currFocused=this.focusableElements.toArray().indexOf(t);if(!e.shiftKey){if(this.currFocused==this.focusableElements.length-1){this.focusableElements.first().focus();this.currFocused=0}else{this.currFocused++;this.focusableElements[this.currFocused].focus()}}else{if(this.currFocused==0){this.focusableElements.last().focus();this.currFocused=this.focusableElements.length-1}else{this.currFocused--;this.focusableElements[this.currFocused].focus()}}break;case Event.KEY_ESC:if(this.active)this._hide(e);break;case 32:this._preventScroll(e);break;case 0:if(e.which==32)this._preventScroll(e);break;case Event.KEY_UP:case Event.KEY_DOWN:case Event.KEY_PAGEDOWN:case Event.KEY_PAGEUP:case Event.KEY_HOME:case Event.KEY_END:if(Prototype.Browser.WebKit&&!["textarea","select"].include(t.tagName.toLowerCase()))e.stop();else if(t.tagName.toLowerCase()=="input"&&["submit","button"].include(t.type)||t.tagName.toLowerCase()=="a")e.stop();break}},_preventScroll:function(e){if(!["input","textarea","select","button"].include(e.element().tagName.toLowerCase()))e.stop()},_deinit:function(){this._removeObservers();Event.stopObserving(window,"resize",this._setWidthAndPosition);if(this.options.transitions){Effect.toggle(this.MBoverlay,'appear',{duration:this.options.overlayDuration,afterFinish:this._removeElements.bind(this)})}else{this.MBoverlay.hide();this._removeElements()}$(this.MBcontent).setStyle({overflow:'',height:''})},_removeElements:function(){$(this.MBoverlay).remove();$(this.MBwindow).remove();if(Prototype.Browser.IE&&!navigator.appVersion.match(/\b7.0\b/)){this._prepareIE("","");window.scrollTo(this.initScrollX,this.initScrollY)}if(typeof this.content=='object'){if(this.content.id&&this.content.id.match(/MB_/)){this.content.id=this.content.id.replace(/MB_/,"")}this.content.select('*[id]').each(function(e){e.id=e.id.replace(/MB_/,"")})}this.initialized=false;this.event("afterHide");this.setOptions(this._options)},_setWidth:function(){$(this.MBwindow).setStyle({width:this.options.width+"px",height:this.options.height+"px"})},_setPosition:function(){$(this.MBwindow).setStyle({left:Math.round((Element.getWidth(document.body)-Element.getWidth(this.MBwindow))/2)+"px"})},_setWidthAndPosition:function(){$(this.MBwindow).setStyle({width:this.options.width+"px"});this._setPosition()},_getScrollTop:function(){var e;if(document.documentElement&&document.documentElement.scrollTop)e=document.documentElement.scrollTop;else if(document.body)e=document.body.scrollTop;return e},_prepareIE:function(e,t){$$('html, body').invoke('setStyle',{width:e,height:e,overflow:t});$$("select").invoke('setStyle',{visibility:t})},event:function(e){if(this.options[e]){var t=this.options[e]();this.options[e]=null;if(t!=undefined)return t;else return true}return true}};Object.extend(Modalbox,Modalbox.Methods);if(Modalbox.overrideAlert)window.alert=Modalbox.alert;Effect.ScaleBy=Class.create();Object.extend(Object.extend(Effect.ScaleBy.prototype,Effect.Base.prototype),{initialize:function(e,t,i,s){this.element=$(e);var s=Object.extend({scaleFromTop:true,scaleMode:'box',scaleByWidth:t,scaleByHeight:i},arguments[3]||{});this.start(s)},setup:function(){this.elementPositioning=this.element.getStyle('position');this.originalTop=this.element.offsetTop;this.originalLeft=this.element.offsetLeft;this.dims=null;if(this.options.scaleMode=='box')this.dims=[this.element.offsetHeight,this.element.offsetWidth];if(/^content/.test(this.options.scaleMode))this.dims=[this.element.scrollHeight,this.element.scrollWidth];if(!this.dims)this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth];this.deltaY=this.options.scaleByHeight;this.deltaX=this.options.scaleByWidth},update:function(e){var t=this.dims[0]+this.deltaY*e;var i=this.dims[1]+this.deltaX*e;t=t>0?t:0;i=i>0?i:0;this.setDimensions(t,i)},setDimensions:function(e,t){var i={};i.width=t+'px';i.height=e+'px';var s=Math.round((e-this.dims[0])/2);var n=Math.round((t-this.dims[1])/2);if(this.elementPositioning=='absolute'||this.elementPositioning=='fixed'){if(!this.options.scaleFromTop)i.top=this.originalTop-s+'px';i.left=this.originalLeft-n+'px'}else{if(!this.options.scaleFromTop)i.top=-s+'px';i.left=-n+'px'}this.element.setStyle(i)}});var EnsembleVideo=EnsembleVideo||{};EnsembleVideo.Platform=function(){this.initCompleted=!1;this.isWebkit=!1;this.isMobilePhone=!1;this.isIphone=!1;this.isAndroid=!1;this.isIos=!1;this.isAndroidPhone=!1;this.isTierTablet=!1;this.isTierIphone=!1;this.isTierRichCss=!1;this.isTierGenericMobile=!1;this.engineWebKit="webkit";this.deviceIphone="iphone";this.deviceIpod="ipod";this.deviceIpad="ipad";this.deviceMacPpc="macintosh";this.deviceAndroid="android";this.deviceGoogleTV="googletv";this.deviceHtcFlyer="htc_flyer";this.deviceWinPhone7="windows phone os 7";this.deviceWinPhone8="windows phone 8";this.deviceWinMob="windows ce";this.deviceWindows="windows";this.deviceIeMob="iemobile";this.devicePpc="ppc";this.enginePie="wm5 pie";this.deviceBB="blackberry";this.deviceBB10="bb10";this.vndRIM="vnd.rim";this.deviceBBStorm="blackberry95";this.deviceBBBold="blackberry97";this.deviceBBBoldTouch="blackberry 99";this.deviceBBTour="blackberry96";this.deviceBBCurve="blackberry89";this.deviceBBCurveTouch="blackberry 938";this.deviceBBTorch="blackberry 98";this.deviceBBPlaybook="playbook";this.deviceSymbian="symbian";this.deviceSymbos="symbos";this.deviceS60="series60";this.deviceS70="series70";this.deviceS80="series80";this.deviceS90="series90";this.devicePalm="palm";this.deviceWebOS="webos";this.deviceWebOShp="hpwos";this.engineBlazer="blazer";this.engineXiino="xiino";this.deviceNuvifone="nuvifone";this.deviceBada="bada";this.deviceTizen="tizen";this.deviceMeego="meego";this.deviceKindle="kindle";this.engineSilk="silk-accelerated";this.vndwap="vnd.wap";this.wml="wml";this.deviceTablet="tablet";this.deviceBrew="brew";this.deviceDanger="danger";this.deviceHiptop="hiptop";this.devicePlaystation="playstation";this.devicePlaystationVita="vita";this.deviceNintendoDs="nitro";this.deviceNintendo="nintendo";this.deviceWii="wii";this.deviceXbox="xbox";this.deviceArchos="archos";this.engineChrome="chrome";this.engineOpera="opera";this.engineNetfront="netfront";this.engineUpBrowser="up.browser";this.engineOpenWeb="openweb";this.deviceMidp="midp";this.uplink="up.link";this.engineTelecaQ="teleca q";this.engineObigo="obigo";this.devicePda="pda";this.mini="mini";this.mobile="mobile";this.mobi="mobi";this.maemo="maemo";this.linux="linux";this.mylocom2="sony/com";this.manuSonyEricsson="sonyericsson";this.manuericsson="ericsson";this.manuSamsung1="sec-sgh";this.manuSony="sony";this.manuHtc="htc";this.svcDocomo="docomo";this.svcKddi="kddi";this.svcVodafone="vodafone";this.disUpdate="update";this.uagent="";this.isChromeBrowser=!1;this.androidVersion=0};EnsembleVideo.Platform.prototype={InitDeviceScan:function(){this.initCompleted=!1;navigator&&navigator.userAgent&&(this.uagent=navigator.userAgent.toLowerCase());this.isWebkit=this.DetectWebkit();this.isIphone=this.DetectIphone();this.isAndroid=this.DetectAndroid();this.isAndroidPhone=this.DetectAndroidPhone();this.isIos=this.DetectIos();this.isTierIphone=this.DetectTierIphone();this.isTierTablet=this.DetectTierTablet();this.isMobilePhone=this.DetectMobileQuick();this.isTierRichCss=this.DetectTierRichCss();this.isTierGenericMobile=this.DetectTierOtherPhones();this.isChromeBrowser=this.DetectChromeBrowser();this.initCompleted=!0},DetectIphone:function(){return this.initCompleted||this.isIphone?this.isIphone:this.uagent.search(this.deviceIphone)>-1?this.DetectIpad()||this.DetectIpod()?!1:!0:!1},DetectIpod:function(){return this.uagent.search(this.deviceIpod)>-1?!0:!1},DetectIphoneOrIpod:function(){return this.DetectIphone()||this.DetectIpod()?!0:!1},DetectIpad:function(){return this.uagent.search(this.deviceIpad)>-1&&this.DetectWebkit()?!0:!1},DetectIos:function(){return this.DetectIphoneOrIpod()||this.DetectIpad()?!0:!1},DetectAndroid:function(){return this.initCompleted||this.isAndroid?this.isAndroid:this.uagent.search(this.deviceAndroid)>-1?(this.androidVersion=this.DetectAndroidVersion(),!0):this.DetectGoogleTV()?!0:this.uagent.search(this.deviceHtcFlyer)>-1?!0:!1},DetectAndroidPhone:function(){return this.initCompleted||this.isAndroidPhone?this.isAndroidPhone:this.DetectAndroid()&&this.uagent.search(this.mobile)>-1?!0:this.DetectOperaAndroidPhone()?!0:this.uagent.search(this.deviceHtcFlyer)>-1?!0:!1},DetectAndroidTablet:function(){return this.DetectAndroid()?this.DetectOperaMobile()?!1:this.uagent.search(this.deviceHtcFlyer)>-1?!1:this.uagent.search(this.mobile)>-1?!1:!0:!1},DetectAndroidWebKit:function(){return this.DetectAndroid()&&this.DetectWebkit()?!0:!1},DetectGoogleTV:function(){return this.uagent.search(this.deviceGoogleTV)>-1?!0:!1},DetectWebkit:function(){return this.initCompleted||this.isWebkit?this.isWebkit:this.uagent.search(this.engineWebKit)>-1?!0:!1},DetectWindowsPhone:function(){return this.DetectWindowsPhone7()||this.DetectWindowsPhone8()?!0:!1},DetectWindowsPhone7:function(){return this.uagent.search(this.deviceWinPhone7)>-1?!0:!1},DetectWindowsPhone8:function(){return this.uagent.search(this.deviceWinPhone8)>-1?!0:!1},DetectWindowsMobile:function(){return this.DetectWindowsPhone()?!1:this.uagent.search(this.deviceWinMob)>-1||this.uagent.search(this.deviceIeMob)>-1||this.uagent.search(this.enginePie)>-1?!0:this.uagent.search(this.devicePpc)>-1&&!(this.uagent.search(this.deviceMacPpc)>-1)?!0:this.uagent.search(this.manuHtc)>-1&&this.uagent.search(this.deviceWindows)>-1?!0:!1},DetectBlackBerry:function(){return this.uagent.search(this.deviceBB)>-1||this.uagent.search(this.vndRIM)>-1?!0:this.DetectBlackBerry10Phone()?!0:!1},DetectBlackBerry10Phone:function(){return this.uagent.search(this.deviceBB10)>-1&&this.uagent.search(this.mobile)>-1?!0:!1},DetectBlackBerryTablet:function(){return this.uagent.search(this.deviceBBPlaybook)>-1?!0:!1},DetectBlackBerryWebKit:function(){return this.DetectBlackBerry()&&this.uagent.search(this.engineWebKit)>-1?!0:!1},DetectBlackBerryTouch:function(){return this.DetectBlackBerry()&&(this.uagent.search(this.deviceBBStorm)>-1||this.uagent.search(this.deviceBBTorch)>-1||this.uagent.search(this.deviceBBBoldTouch)>-1||this.uagent.search(this.deviceBBCurveTouch)>-1)?!0:!1},DetectBlackBerryHigh:function(){return this.DetectBlackBerryWebKit()?!1:this.DetectBlackBerry()&&(this.DetectBlackBerryTouch()||this.uagent.search(this.deviceBBBold)>-1||this.uagent.search(this.deviceBBTour)>-1||this.uagent.search(this.deviceBBCurve)>-1)?!0:!1},DetectBlackBerryLow:function(){return this.DetectBlackBerry()?this.DetectBlackBerryHigh()||this.DetectBlackBerryWebKit()?!1:!0:!1},DetectS60OssBrowser:function(){return this.DetectWebkit()?this.uagent.search(this.deviceS60)>-1||this.uagent.search(this.deviceSymbian)>-1?!0:!1:!1},DetectSymbianOS:function(){return this.uagent.search(this.deviceSymbian)>-1||this.uagent.search(this.deviceS60)>-1||this.uagent.search(this.deviceSymbos)>-1&&this.DetectOperaMobile||this.uagent.search(this.deviceS70)>-1||this.uagent.search(this.deviceS80)>-1||this.uagent.search(this.deviceS90)>-1?!0:!1},DetectPalmOS:function(){return this.DetectPalmWebOS()?!1:this.uagent.search(this.devicePalm)>-1||this.uagent.search(this.engineBlazer)>-1||this.uagent.search(this.engineXiino)>-1?!0:!1},DetectPalmWebOS:function(){return this.uagent.search(this.deviceWebOS)>-1?!0:!1},DetectWebOSTablet:function(){return this.uagent.search(this.deviceWebOShp)>-1&&this.uagent.search(this.deviceTablet)>-1?!0:!1},DetectChromeBrowser:function(){return this.uagent.search(this.engineChrome)>-1?!0:!1},DetectOperaMobile:function(){return this.uagent.search(this.engineOpera)>-1&&(this.uagent.search(this.mini)>-1||this.uagent.search(this.mobi)>-1)?!0:!1},DetectOperaAndroidPhone:function(){return this.uagent.search(this.engineOpera)>-1&&this.uagent.search(this.deviceAndroid)>-1&&this.uagent.search(this.mobi)>-1?!0:!1},DetectOperaAndroidTablet:function(){return this.uagent.search(this.engineOpera)>-1&&this.uagent.search(this.deviceAndroid)>-1&&this.uagent.search(this.deviceTablet)>-1?!0:!1},DetectKindle:function(){return this.uagent.search(this.deviceKindle)>-1&&!this.DetectAndroid()?!0:!1},DetectAmazonSilk:function(){return this.uagent.search(this.engineSilk)>-1?!0:!1},DetectGarminNuvifone:function(){return this.uagent.search(this.deviceNuvifone)>-1?!0:!1},DetectBada:function(){return this.uagent.search(this.deviceBada)>-1?!0:!1},DetectTizen:function(){return this.uagent.search(this.deviceTizen)>-1?!0:!1},DetectMeego:function(){return this.uagent.search(this.deviceMeego)>-1?!0:!1},DetectDangerHiptop:function(){return this.uagent.search(this.deviceDanger)>-1||this.uagent.search(this.deviceHiptop)>-1?!0:!1},DetectSonyMylo:function(){return this.uagent.search(this.manuSony)>-1&&(this.uagent.search(this.qtembedded)>-1||this.uagent.search(this.mylocom2)>-1)?!0:!1},DetectMaemoTablet:function(){return this.uagent.search(this.maemo)>-1?!0:this.uagent.search(this.linux)>-1&&this.uagent.search(this.deviceTablet)>-1&&!this.DetectWebOSTablet()&&!this.DetectAndroid()?!0:!1},DetectArchos:function(){return this.uagent.search(this.deviceArchos)>-1?!0:!1},DetectGameConsole:function(){return this.DetectSonyPlaystation()||this.DetectNintendo()||this.DetectXbox()?!0:!1},DetectSonyPlaystation:function(){return this.uagent.search(this.devicePlaystation)>-1?!0:!1},DetectGamingHandheld:function(){return this.uagent.search(this.devicePlaystation)>-1&&this.uagent.search(this.devicePlaystationVita)>-1?!0:!1},DetectNintendo:function(){return this.uagent.search(this.deviceNintendo)>-1||this.uagent.search(this.deviceWii)>-1||this.uagent.search(this.deviceNintendoDs)>-1?!0:!1},DetectXbox:function(){return this.uagent.search(this.deviceXbox)>-1?!0:!1},DetectBrewDevice:function(){return this.uagent.search(this.deviceBrew)>-1?!0:!1},DetectSmartphone:function(){return this.DetectTierIphone()||this.DetectS60OssBrowser()||this.DetectSymbianOS()||this.DetectWindowsMobile()||this.DetectBlackBerry()||this.DetectPalmOS()?!0:!1},DetectMobileQuick:function(){return this.DetectTierTablet()?!1:this.initCompleted||this.isMobilePhone?this.isMobilePhone:this.DetectSmartphone()?!0:this.uagent.search(this.mobile)>-1?!0:this.DetectKindle()||this.DetectAmazonSilk()?!0:this.uagent.search(this.deviceMidp)>-1||this.DetectBrewDevice()?!0:this.DetectOperaMobile()||this.DetectArchos()?!0:this.uagent.search(this.engineObigo)>-1||this.uagent.search(this.engineNetfront)>-1||this.uagent.search(this.engineUpBrowser)>-1||this.uagent.search(this.engineOpenWeb)>-1?!0:!1},DetectMobileLong:function(){return this.DetectMobileQuick()?!0:this.DetectGameConsole()?!0:this.DetectDangerHiptop()||this.DetectMaemoTablet()||this.DetectSonyMylo()||this.DetectGarminNuvifone()?!0:this.uagent.search(this.devicePda)>-1&&!(this.uagent.search(this.disUpdate)>-1)?!0:this.uagent.search(this.manuSamsung1)>-1||this.uagent.search(this.manuSonyEricsson)>-1||this.uagent.search(this.manuericsson)>-1?!0:this.uagent.search(this.svcDocomo)>-1||this.uagent.search(this.svcKddi)>-1||this.uagent.search(this.svcVodafone)>-1?!0:!1},DetectTierTablet:function(){return this.initCompleted||this.isTierTablet?this.isTierTablet:this.DetectIpad()||this.DetectAndroidTablet()||this.DetectBlackBerryTablet()||this.DetectWebOSTablet()?!0:!1},DetectTierIphone:function(){return this.initCompleted||this.isTierIphone?this.isTierIphone:this.DetectIphoneOrIpod()||this.DetectAndroidPhone()||this.DetectWindowsPhone()||this.DetectBlackBerry10Phone()||this.DetectPalmWebOS()||this.DetectBada()||this.DetectTizen()||this.DetectGamingHandheld()?!0:this.DetectBlackBerryWebKit()&&this.DetectBlackBerryTouch()?!0:!1},DetectTierRichCss:function(){return this.initCompleted||this.isTierRichCss?this.isTierRichCss:this.DetectTierIphone()||this.DetectKindle()||this.DetectTierTablet()?!1:this.DetectMobileQuick()?this.DetectWebkit()?!0:this.DetectS60OssBrowser()||this.DetectBlackBerryHigh()||this.DetectWindowsMobile()||this.uagent.search(this.engineTelecaQ)>-1?!0:!1:!1},DetectTierOtherPhones:function(){return this.initCompleted||this.isTierGenericMobile?this.isTierGenericMobile:this.DetectTierIphone()||this.DetectTierRichCss()||this.DetectTierTablet()?!1:this.DetectMobileLong()?!0:!1},DetectAndroidVersion:function(){var e=0;try{e=parseFloat(this.uagent.slice(this.uagent.indexOf(this.deviceAndroid)+8))}catch(e){console.log(e.message)}return e}};var platform=new EnsembleVideo.Platform;platform.InitDeviceScan();var contentPreview=Class.create({debugMode:false,previewContentSelector:'[class="previewContent"],.previewContent',previewUrl:'sites/index.aspx',refereshTimer:'',timeOut:'',initialize:function(){try{jQuery('.previewContent').on('click',function(){contentPreviewInstance.preparePreview(this)});if($('refreshTimer')){this.refereshTimer=$('refreshTimer').down().readAttribute('id')}}catch(e){}},preparePreview:function(e){var t=e;if($(t)){if($(t).readAttribute("src")!=null)t=$(t).up();var i=$(t).readAttribute('rel');var s=$(t).readAttribute('title');s=this.htmlDecode(s.unescapeHTML());if(!this.refereshTimer.empty()){$find(this.refereshTimer)._stopTimer()}app.Old_App_Code.DataAccess.Token(function(e){var t='?ContentID='+i+'&Token='+e+"&isResponsive=true"+"&displayCaptionSearch=true&displayAnnotations=true&isSharedLibraryContentPreview="+this.isSharedLibraryContentPreview();app.Old_App_Code.DataAccess.CanEmbedAndShareContent(i,function(e){if(!e){t+='&displaySharing=false&displayEmbedCode=false'}this.showPreview(t,s)}.bind(this))}.bind(this))}},htmlDecode:function(e){if(e==null)return'';var t=document.createElement('a');t.innerHTML=e;return t.textContent},showPreview:function(e,t){setModalConfig(t,this.previewUrl+e);this.hackForiPadScroller()},getQueryStringValue:function(e,t,i){var s=$H(t.parseQuery());var n='';s.keys().each(function(e){s.set(e.toLowerCase(),s.get(e))});if(typeof s.get(e.toLowerCase())!='undefined')n=s.get(e.toLowerCase());else if(typeof i!='undefined')n=i;n=n=='false'?new Boolean(false):n=='true'?new Boolean(true):n;return n},log:function(e){if(this.debugMode==true){try{console.log(e)}catch(e){}}},hackForiPadScroller:function(){if(!platform.isIos)return;if($('MB_frame')){$('MB_frame').addClassName('MB_frame_fix_for_iPad');clearTimeout(this.timeOut)}else{this.timeOut=setTimeout(this.hackForiPadScroller,1e3)}},isSharedLibraryContentPreview:function(){return location.href.toLowerCase().indexOf('sharedlibrary.aspx')>-1}});document.observe('dom:loaded',function(){contentPreviewInstance=new contentPreview;jQuery('#myModal').on('hide.bs.modal',function(e){jQuery(".modal-title").text('');jQuery("#modalIframe").attr("src",'');jQuery("#modalIframe").css("height",'150px')})});function setModalConfig(e,t){jQuery("#modalLabel").text(e);jQuery("#modalIframe").attr("src",t);jQuery("#myModal").modal()}(function(u){var a=u.fn.domManip,c="_tmplitem",i=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,h={},d={},f,r={key:0,data:{}},p=0,m=0,o=[];function _(e,t,i,s){var n={data:s||(t?t.data:{}),_wrap:t?t._wrap:null,tmpl:null,parent:t||null,nodes:[],calls:w,nest:E,wrap:S,html:x,update:T};e&&u.extend(n,e,{nodes:[],parent:t});if(i){n.tmpl=i;n._ctnt=n._ctnt||n.tmpl(u,n);n.key=++p;(o.length?d:h)[p]=n}return n}u.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(l,c){u.fn[l]=function(e){var t=[],i=u(e),s,n,o,r,a=this.length===1&&this[0].parentNode;f=h||{};if(a&&a.nodeType===11&&a.childNodes.length===1&&i.length===1){i[c](this[0]);t=this}else{for(n=0,o=i.length;n<o;n++){m=n;s=(n>0?this.clone(true):this).get();u.fn[c].apply(u(i[n]),s);t=t.concat(s)}m=0;t=this.pushStack(t,l,i.selector)}r=f;f=null;u.tmpl.complete(r);return t}});u.fn.extend({tmpl:function(e,t,i){return u.tmpl(this[0],e,t,i)},tmplItem:function(){return u.tmplItem(this[0])},template:function(e){return u.template(e,this[0])},domManip:function(e,t,i){if(e[0]&&e[0].nodeType){var s=u.makeArray(arguments),n=e.length,o=0,r;while(o<n&&!(r=u.data(e[o++],"tmplItem")));if(n>1)s[0]=[u.makeArray(e)];if(r&&m)s[2]=function(e){u.tmpl.afterManip(this,e,i)};a.apply(this,s)}else a.apply(this,arguments);m=0;!f&&u.tmpl.complete(h);return this}});u.extend({tmpl:function(t,e,i,s){var n,o=!s;if(o){s=r;t=u.template[t]||u.template(null,t);d={}}else if(!t){t=s.tmpl;h[s.key]=s;s.nodes=[];s.wrapped&&v(s,s.wrapped);return u(l(s,null,s.tmpl(u,s)))}if(!t)return[];if(typeof e==="function")e=e.call(s||{});i&&i.wrapped&&v(i,i.wrapped);n=u.isArray(e)?u.map(e,function(e){return e?_(i,s,t,e):null}):[_(i,s,t,e)];return o?u(l(s,null,n)):n},tmplItem:function(e){var t;if(e instanceof u)e=e[0];while(e&&e.nodeType===1&&!(t=u.data(e,"tmplItem"))&&(e=e.parentNode));return t||r},template:function(e,t){if(t){if(typeof t==="string")t=s(t);else if(t instanceof u)t=t[0]||{};if(t.nodeType)t=u.data(t,"tmpl")||u.data(t,"tmpl",s(t.innerHTML));return typeof e==="string"?u.template[e]=t:t}return e?typeof e!=="string"?u.template(null,e):u.template[e]||u.template(null,i.test(e)?e:u(e)):null},encode:function(e){return(""+e).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});u.extend(u.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},if:{open:"if(($notnull_1) && $1a){",close:"}"},else:{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"},"!":{open:""}},complete:function(){h={}},afterManip:function(e,t,i){var s=t.nodeType===11?u.makeArray(t.childNodes):t.nodeType===1?[t]:[];i.call(e,t);y(s);m++}});function l(t,e,i){var n,s=i?u.map(i,function(e){return typeof e==="string"?t.key?e.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+c+'="'+t.key+'" $2'):e:l(e,t,e._ctnt)}):t;if(e)return s;s=s.join("");s.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(e,t,i,s){n=u(i).get();y(n);if(t)n=g(t).concat(n);if(s)n=n.concat(g(s))});return n?n:g(s)}function g(e){var t=document.createElement("div");t.innerHTML=e;return u.makeArray(t.childNodes)}function s(e){return new Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+u.trim(e).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(e,t,i,s,n,o,r){var a=u.tmpl.tag[i],l,c,h;if(!a)throw"Template command not found: "+i;l=a._default||[];if(o&&!/\w$/.test(n)){n+=o;o=""}if(n){n=b(n);r=r?","+b(r)+")":o?")":"";c=o?n.indexOf(".")>-1?n+o:"("+n+").call($item"+r:n;h=o?c:"(typeof("+n+")==='function'?("+n+").call($item):("+n+"))"}else h=c=l.$1||"null";s=b(s);return"');"+a[t?"close":"open"].split("$notnull_1").join(n?"typeof("+n+")!=='undefined' && ("+n+")!=null":"true").split("$1a").join(h).split("$1").join(c).split("$2").join(s?s.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g,function(e,t,i,s){s=s?","+s+")":i?")":"";return s?"("+t+").call($item"+s:e}):l.$2||"")+"_.push('"})+"');}return _;")}function v(e,t){e._wrap=l(e,true,u.isArray(t)?t:[i.test(t)?t:u(t).html()]).join("")}function b(e){return e?e.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function n(e){var t=document.createElement("div");t.appendChild(e.cloneNode(true));return t.innerHTML}function y(e){var a="_"+m,t,i,l={},s,n,o;for(s=0,n=e.length;s<n;s++){if((t=e[s]).nodeType!==1)continue;i=t.getElementsByTagName("*");for(o=i.length-1;o>=0;o--)r(i[o]);r(t)}function r(e){var t,i=e,s,n,o;if(o=e.getAttribute(c)){while(i.parentNode&&(i=i.parentNode).nodeType===1&&!(t=i.getAttribute(c)));if(t!==o){i=i.parentNode?i.nodeType===11?0:i.getAttribute(c)||0:0;if(!(n=h[o])){n=d[o];n=_(n,h[i]||d[i],null,true);n.key=++p;h[p]=n}m&&r(o)}e.removeAttribute(c)}else if(m&&(n=u.data(e,"tmplItem"))){r(n.key);h[n.key]=n;i=u.data(e.parentNode,"tmplItem");i=i?i.key:0}if(n){s=n;while(s&&s.key!=i){s.nodes.push(e);s=s.parent}delete n._ctnt;delete n._wrap;u.data(e,"tmplItem",n)}function r(e){e=e+a;n=l[e]=l[e]||_(n,h[n.parent.key+a]||n.parent,null,true)}}}function w(e,t,i,s){if(!e)return o.pop();o.push({_:e,tmpl:t,item:this,data:i,options:s})}function E(e,t,i){return u.tmpl(u.template(e),t,i,this)}function S(e,t){var i=e.options||{};i.wrapped=t;return u.tmpl(u.template(e.tmpl),e.data,i,e.item)}function x(e,t){var i=this._wrap;return u.map(u(u.isArray(i)?i.join(""):i).filter(e||"*"),function(e){return t?e.innerText||e.textContent:e.outerHTML||n(e)})}function T(){var e=this.nodes;u.tmpl(null,null,null,this).insertBefore(e[0]);u(e).remove()}})(jQuery);(function(r,a){var l=r.klass=function(e,t){if(!t){t=e;e=a}var i=t.init||(t.init=function(){e&&e.prototype.init.apply(this,arguments)}),s=function(){},n,o;s.prototype=(e||l).prototype;n=i.prototype=new s;i._super=e;for(o in t){if(o==="_klass")r.extend(i,t[o]);else r.isFunction(n[o]=t[o])&&(t[o]._klass={klass:i,name:o})}n.constructor=i;return i},c=[].slice;l.prototype._super=function(e,t){var i=e.callee,s=(i?e:t).callee._klass,n=i?s.name:e,o=s.klass._super.prototype[n];return o.apply(this,c.call(arguments,1+!i))}})(jQuery);window.Modernizr=function(e,t,o){function i(e){p.cssText=e}function s(e,t){return i(prefixes.join(e+";")+(t||""))}function r(e,t){return typeof e===t}function n(e,t){return!!~(""+e).indexOf(t)}function a(e,t,i){for(var s in e){var n=t[e[s]];if(n!==o)return i===!1?e[s]:r(n,"function")?n.bind(i||t):n}return!1}var l="2.6.3",c={},h=!0,u=t.documentElement,d="modernizr",f=t.createElement(d),p=f.style,m,_={}.toString,g={svg:"http://www.w3.org/2000/svg"},v={},b={},y={},w=[],E=w.slice,S,x={}.hasOwnProperty,T;!r(x,"undefined")&&!r(x.call,"undefined")?T=function(e,t){return x.call(e,t)}:T=function(e,t){return t in e&&r(e.constructor.prototype[t],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(s){var n=this;if(typeof n!="function")throw new TypeError;var o=E.call(arguments,1),r=function(){if(this instanceof r){var e=function(){};e.prototype=n.prototype;var t=new e,i=n.apply(t,o.concat(E.call(arguments)));return Object(i)===i?i:t}return n.apply(s,o.concat(E.call(arguments)))};return r}),v.svg=function(){return!!t.createElementNS&&!!t.createElementNS(g.svg,"svg").createSVGRect};for(var k in v)T(v,k)&&(S=k.toLowerCase(),c[S]=v[k](),w.push((c[S]?"":"no-")+S));return c.addTest=function(e,t){if(typeof e=="object")for(var i in e)T(e,i)&&c.addTest(i,e[i]);else{e=e.toLowerCase();if(c[e]!==o)return c;t=typeof t=="function"?t():t,typeof h!="undefined"&&h&&(u.className+=" "+(t?"":"no-")+e),c[e]=t}return c},i(""),f=m=null,function(e,r){function i(e,t){var i=e.createElement("p"),s=e.getElementsByTagName("head")[0]||e.documentElement;return i.innerHTML="x<style>"+t+"</style>",s.insertBefore(i.lastChild,s.firstChild)}function a(){var e=g.elements;return typeof e=="string"?e.split(" "):e}function l(e){var t=m[e[f]];return t||(t={},p++,e[f]=p,m[p]=t),t}function s(e,t,i){t||(t=r);if(_)return t.createElement(e);i||(i=l(t));var s;return i.cache[e]?s=i.cache[e].cloneNode():u.test(e)?s=(i.cache[e]=i.createElem(e)).cloneNode():s=i.createElem(e),s.canHaveChildren&&!h.test(e)?i.frag.appendChild(s):s}function t(e,t){e||(e=r);if(_)return e.createDocumentFragment();t=t||l(e);var i=t.frag.cloneNode(),s=0,n=a(),o=n.length;for(;s<o;s++)i.createElement(n[s]);return i}function n(t,i){i.cache||(i.cache={},i.createElem=t.createElement,i.createFrag=t.createDocumentFragment,i.frag=i.createFrag()),t.createElement=function(e){return g.shivMethods?s(e,t,i):i.createElem(e)},t.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+a().join().replace(/\w+/g,function(e){return i.createElem(e),i.frag.createElement(e),'c("'+e+'")'})+");return n}")(g,i.frag)}function o(e){e||(e=r);var t=l(e);return g.shivCSS&&!d&&!t.hasCSS&&(t.hasCSS=!!i(e,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),_||n(e,t),e}var c=e.html5||{},h=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,u=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,d,f="_html5shiv",p=0,m={},_;(function(){try{var e=r.createElement("a");e.innerHTML="<xyz></xyz>",d="hidden"in e,_=e.childNodes.length==1||function(){r.createElement("a");var e=r.createDocumentFragment();return typeof e.cloneNode=="undefined"||typeof e.createDocumentFragment=="undefined"||typeof e.createElement=="undefined"}()}catch(e){d=!0,_=!0}})();var g={elements:c.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:c.shivCSS!==!1,supportsUnknownElements:_,shivMethods:c.shivMethods!==!1,type:"default",shivDocument:o,createElement:s,createDocumentFragment:t};e.html5=g,o(r)}(this,t),c._version=l,u.className=u.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(h?" js "+w.join(" "):""),c}(this,this.document),function(e,d,l){function u(e){return"[object Function]"==s.call(e)}function f(e){return"string"==typeof e}function p(){}function m(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function _(){var e=b.shift();y=1,e?e.t?g(function(){("c"==e.t?C.injectCss:C.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),_()):y=0}function o(i,s,e,t,n,o,r){function a(e){if(!c&&m(l.readyState)&&(u.r=c=1,!y&&_(),l.onload=l.onreadystatechange=null,e)){"img"!=i&&g(function(){E.removeChild(l)},50);for(var t in T[s])T[s].hasOwnProperty(t)&&T[s][t].onload()}}var r=r||C.errorTimeout,l=d.createElement(i),c=0,h=0,u={t:e,s:s,e:n,a:o,x:r};1===T[s]&&(h=1,T[s]=[]),"object"==i?l.data=s:(l.src=s,l.type=i),l.width=l.height="0",l.onerror=l.onload=l.onreadystatechange=function(){a.call(this,h)},b.splice(t,0,u),"img"!=i&&(h||2===T[s]?(E.insertBefore(l,w?null:v),g(a,r)):T[s].push(l))}function t(e,t,i,s,n){return y=0,t=t||"j",f(e)?o("c"==t?a:r,e,t,this.i++,i,s,n):(b.splice(this.i++,0,e),1==b.length&&_()),this}function c(){var e=C;return e.loader={load:t,i:0},e}var i=d.documentElement,g=e.setTimeout,v=d.getElementsByTagName("script")[0],s={}.toString,b=[],y=0,n="MozAppearance"in i.style,w=n&&!!d.createRange().compareNode,E=w?i:v.parentNode,i=e.opera&&"[object Opera]"==s.call(e.opera),i=!!d.attachEvent&&!i,r=n?"object":i?"script":"img",a=i?"script":r,S=Array.isArray||function(e){return"[object Array]"==s.call(e)},x=[],T={},k={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}},h,C;C=function(e){function a(e){var e=e.split("!"),t=x.length,i=e.pop(),s=e.length,i={url:i,origUrl:i,prefixes:e},n,o,r;for(o=0;o<s;o++)r=e[o].split("="),(n=k[r.shift()])&&(i=n(i,r));for(o=0;o<t;o++)i=x[o](i);return i}function h(e,t,i,s,n){var o=a(e),r=o.autoCallback;o.url.split(".").pop().split("?").shift(),o.bypass||(t&&(t=u(t)?t:t[e]||t[s]||t[e.split("/").pop().split("?")[0]]),o.instead?o.instead(e,t,i,s,n):(T[o.url]?o.noexec=!0:T[o.url]=1,i.load(o.url,o.forceCSS||!o.forceJS&&"css"==o.url.split(".").pop().split("?").shift()?"c":l,o.noexec,o.attrs,o.timeout),(u(t)||u(r))&&i.load(function(){c(),t&&t(o.origUrl,n,s),r&&r(o.origUrl,n,s),T[o.url]=2})))}function t(e,t){function i(i,e){if(i){if(f(i))e||(o=function(){var e=[].slice.call(arguments);r.apply(this,e),a()}),h(i,o,t,0,s);else if(Object(i)===i)for(c in l=function(){var e=0,t;for(t in i)i.hasOwnProperty(t)&&e++;return e}(),i)i.hasOwnProperty(c)&&(!e&&!--l&&(u(o)?o=function(){var e=[].slice.call(arguments);r.apply(this,e),a()}:o[c]=function(t){return function(){var e=[].slice.call(arguments);t&&t.apply(this,e),a()}}(r[c])),h(i[c],o,t,c,s))}else!e&&a()}var s=!!e.test,n=e.load||e.both,o=e.callback||p,r=o,a=e.complete||p,l,c;i(s?e.yep:e.nope,!!n),n&&i(n)}var i,s,n=this.yepnope.loader;if(f(e))h(e,0,n,0);else if(S(e))for(i=0;i<e.length;i++)s=e[i],f(s)?h(s,0,n,0):S(s)?C(s):Object(s)===s&&t(s,n);else Object(e)===e&&t(e,n)},C.addPrefix=function(e,t){k[e]=t},C.addFilter=function(e){x.push(e)},C.errorTimeout=1e4,null==d.readyState&&d.addEventListener&&(d.readyState="loading",d.addEventListener("DOMContentLoaded",h=function(){d.removeEventListener("DOMContentLoaded",h,0),d.readyState="complete"},0)),e.yepnope=c(),e.yepnope.executeStack=_,e.yepnope.injectJs=function(e,t,i,s,n,o){var r=d.createElement("script"),a,l,s=s||C.errorTimeout;r.src=e;for(l in i)r.setAttribute(l,i[l]);t=o?_:t||p,r.onreadystatechange=r.onload=function(){!a&&m(r.readyState)&&(a=1,t(),r.onload=r.onreadystatechange=null)},g(function(){a||(a=1,t(1))},s),n?r.onload():v.parentNode.insertBefore(r,v)},e.yepnope.injectCss=function(e,t,i,s,n,o){var s=d.createElement("link"),r,t=o?_:t||p;s.href=e,s.rel="stylesheet",s.type="text/css";for(r in i)s.setAttribute(r,i[r]);n||(v.parentNode.insertBefore(s,v),g(t,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))};jQuery.fn.confirm=function(l){l=jQuery.extend({msg:'Are you sure?',stopAfter:'never',wrapper:'<span></span>',eventType:'click',dialogShow:'show',dialogSpeed:'',timeout:0},l);l.stopAfter=l.stopAfter.toLowerCase();if(!l.stopAfter in['never','once','ok','cancel']){l.stopAfter='never'}l.buttons=jQuery.extend({ok:'Yes',cancel:'No',wrapper:'<a href="#"></a>',separator:'/'},l.buttons);var c=l.eventType;return this.each(function(){var i=this;var s=jQuery(i);var e;var t=function(){var e=jQuery._data(i,'events');if(!e&&i.href){s.bind('click',function(){document.location=i.href});e=jQuery._data(i,'events')}else if(!e){return}i._handlers=new Array;for(var t in e[c]){i._handlers.push(e[c][t])}};var n=jQuery(l.buttons.wrapper).append(l.buttons.ok).click(function(){if(l.timeout!=0){clearTimeout(e)}s.unbind(c,a);s.show();r.hide();if(i._handlers!=undefined){jQuery.each(i._handlers,function(){s.click(this.handler)})}s.click();if(l.stopAfter!='ok'&&l.stopAfter!='once'){s.unbind(c);s.one(c,a)}return false});var o=jQuery(l.buttons.wrapper).append(l.buttons.cancel).click(function(){if(l.timeout!=0){clearTimeout(e)}if(l.stopAfter!='cancel'&&l.stopAfter!='once'){s.one(c,a)}s.show();r.hide();return false});if(l.buttons.cls){n.addClass(l.buttons.cls);o.addClass(l.buttons.cls)}var r=jQuery(l.wrapper).append(l.msg).append(n).append(l.buttons.separator).append(o);var a=function(){jQuery(this).hide();if(l.dialogShow!='show'){r.hide()}r.insertBefore(this);r[l.dialogShow](l.dialogSpeed);if(l.timeout!=0){clearTimeout(e);e=setTimeout(function(){o.click();s.one(c,a)},l.timeout)}return false};t();s.unbind(c);i._confirm=a;i._confirmEvent=c;s.one(c,a)})};'use strict';var EnsembleVideo=EnsembleVideo||{};EnsembleVideo.SocialSharing=function(e,t){this.id=Math.floor(Math.random()*(100-1+1))+1;this.container=document.getElementById(e);this.listClass="ensembleVideoShare soc";this.settings={url:encodeURIComponent(t.url!=null?t.url:''),title:encodeURIComponent(t.title!=null?t.title:''),summary:encodeURIComponent(t.summary!=null?t.summary:''),imageUrl:encodeURIComponent(t.imageUrl!=null?t.imageUrl:'')}};EnsembleVideo.SocialSharing.prototype=function(){var r=[{name:'evTwitter',url:'//twitter.com/intent/tweet?text={TITLE}&url={URL}',cssclass:'soc-twitter',height:420,width:550,title:'Twitter Share'},{name:'evFacebook',url:'//www.facebook.com/sharer/sharer.php?u={URL}',cssclass:'soc-facebook',height:306,width:650,title:'Facebook Share'},{name:'evLinkedIn',url:'//www.linkedin.com/shareArticle?mini=true&url={URL}&title={TITLE}&summary={SUMMARY}&source={URL}',cssclass:'soc-linkedin',height:570,width:520,title:'LinkedIn Share'},{name:'evPinterest',url:'//pinterest.com/pin/create/button/?url={URL}&description={SUMMARY}&media={IMAGE_URL}',cssclass:'soc-pinterest',height:650,width:1024,title:'Pinterest Share'},{name:'evMail',url:'mailto:?subject={TITLE}&body={URL}%0D%0A%0D%0A{SUMMARY}',cssclass:'soc-email1 soc-icon-last',sameWindow:true,title:'Mail Share'}],a=function(){var e=parent!==window,t=window.location;if(e){t=document.referrer}return encodeURIComponent(t)},e=function(){if(this.container==null)return;try{var e=document.createElement('ul');e.className=this.listClass;e.style.listStyleType="none";e.id="shareButtonsList"+this.id;if(this.settings.url=='')this.settings.url=a();for(var t=0,i=r.length;t<i;t++){var s=r[t];var n=document.createElement('li');var o=document.createElement('a');o.id=s.name+this.id;o.className=s.cssclass;o.href=s.url.replace(/{URL}/g,this.settings.url).replace(/{TITLE}/g,this.settings.title).replace(/{SUMMARY}/g,this.settings.summary).replace(/{IMAGE_URL}/g,this.settings.imageUrl);o.setAttribute('template',t);if(s.sameWindow==null||s.sameWindow==false){o.onclick=function(){var e=this.getAttribute("template");var t=screen.width/2-r[e].width/2;var i=screen.height/2-r[e].height/2;window.open(this.href,'Share','width='+r[e].width+',height='+r[e].height+',scrollbars=yes,top='+i+', left='+t);return false}}n.appendChild(o);e.appendChild(n)}this.container.appendChild(e);resizeSocialSharingIFrame()}catch(e){console.log(e)}};return{Create:e}}();function resizeSocialSharingIFrame(){var e;var t=setInterval(function(){if(jQuery('#ThumbnailImage').height()==0)return;clearInterval(t);e=setIFrameConfig(jQuery('html').height(),"modalIframe");window.parent.postMessage(e,"*")},250);window.onresize=function(){e=setIFrameConfig(jQuery('html').height(),"modalIframe");window.parent.postMessage(e,"*")}}function setIFrameConfig(e,t){var i=JSON.stringify({iFrameWidth:'100%',iFrameHeight:e+'px',iFrameId:t});return i}function GetLanguage(e){var t="en-US";var i=getCookie("layout");var s=i.split("&");for(var n=0;n<s.length;n++){var o=s[n].indexOf("userLanguage=");if(o>-1){t=s[n].substring(13);break}}if(e){var r=t.indexOf('-');if(r>-1){t=t.substring(0,r)}}return t}function GetUserDateFormat(e){var t="MM/DD/YYYY";var i=getCookie("layout");var s=i.split("&");for(var n=0;n<s.length;n++){var o=s[n].indexOf("userDateFormat=");if(o>-1){if(e)t=s[n].substring(15);else t=s[n].substring(15).toUpperCase();break}}return t}function GetUserDateTimeFormat(){var e="MM/DD/YYYY";var t="hh:mm A";var i=getCookie("layout");var s=i.split("&");for(var n=0;n<s.length;n++){var o=s[n].indexOf("userDateFormat=");var r=s[n].indexOf("userTimeFormat=");if(o>-1){e=s[n].substring(15).toUpperCase()}if(r>-1){t=s[n].substring(15);t=t.replace("tt","A")}}return e+" "+t}function GetUserTimeZone(){var e="America/New_York";var t=getCookie("layout");var i=t.split("&");for(var s=0;s<i.length;s++){var n=i[s].indexOf("userTimeZone=");if(n>-1){e=i[s].substring(13);break}}return e}function GetTimeFormat(){return Show24Hours()?"HH:mm":"hh:mm A"}function Show24Hours(){var e=true;var t=getCookie("layout");var i=t.split("&");for(var s=0;s<i.length;s++){var n=i[s].indexOf("userTimeFormat=");if(n>-1){var o=i[s].substring(15);if(o.indexOf("tt")>-1)e=false}}return e}function getCookie(e){var t=e+"=";var i=decodeURIComponent(document.cookie);var s=i.split(';');for(var n=0;n<s.length;n++){var o=s[n];while(o.charAt(0)==' '){o=o.substring(1)}if(o.indexOf(t)==0){return o.substring(t.length,o.length)}}return""}function ConvertFromUtcToLocalDateTimeFromNow(t){try{var e="Just Now";var i=GetUserTimeZone();var s=moment.utc(t).tz(i).fromNow();if(s.indexOf(e)>-1)s=moment.utc(t).tz(i).fromNow(true);return s}catch(e){console.log(e);return t}}function ConvertFromUtcToLocalDateWithUserFormat(t){try{var e=GetUserTimeZone();var i=moment.utc(t).tz(e).toDate();var s=GetUserDateFormat();return formatDateTime(i,s)}catch(e){console.log(e);return t}}function formatDateTime(e,t){return moment(e).format(t)}(function(n){'use strict';n(document).ready(function(){var e=new window.Accessibility});window.Accessibility=jQuery.klass({init:function(){this.tabbedControlsSelector=this.playerSelector+', .tabbed-control, .jw-settings-content-item, .jw-button-color, .jw-logo';this.handleCustomAccessibility()},handleCustomAccessibility:function(){var s=this;n(document).on('keyup',function(e){var t=e.keyCode?e.keyCode:e.which;if(t===9||t===27){s.setFocusOnActiveElement(n(document.activeElement))}if(t===13){var i=n(document.activeElement);if(s.isActiveElementEnterChangeFocusControl(i)){s.setFocusOnActiveElement(i)}}});if(document.addEventListener){document.addEventListener('webkitfullscreenchange',function(){s.setFocusOnActiveElement(n(document.activeElement))},false);document.addEventListener('mozfullscreenchange',function(){s.setFocusOnActiveElement(n(document.activeElement))},false);document.addEventListener('fullscreenchange',function(){s.setFocusOnActiveElement(n(document.activeElement))},false);document.addEventListener('MSFullscreenChange',function(){s.setFocusOnActiveElement(n(document.activeElement))},false)}n(this.tabbedControlsSelector).on('blur',function(){if(s.isActiveElementTabbedControl(n(document.activeElement)))return;n(s.tabbedControlsSelector).removeClass('focus-outline')})},setFocusOnActiveElement:function(e){n(this.tabbedControlsSelector).removeClass('focus-outline');if(this.isActiveElementTabbedControl(e)){e.addClass('focus-outline')}},isActiveElementTabbedControl:function(e){return e.hasClass('tabbed-control')||e.hasClass('jwplayer')||e.hasClass('jw-settings-content-item')||e.hasClass('jw-button-color')||e.hasClass('jw-logo')},isActiveElementEnterChangeFocusControl:function(e){return e.hasClass('jw-settings-playbackRates')||e.hasClass('jw-icon-settings')||e.hasClass('jw-settings-quality')||e.hasClass('jw-settings-content-item')}})})(jQuery);(function(){var l,i,n,r,o={}.hasOwnProperty;(r=function(){function e(){this.options_index=0,this.parsed=[]}return e.prototype.add_node=function(e){return"OPTGROUP"===e.nodeName.toUpperCase()?this.add_group(e):this.add_option(e)},e.prototype.add_group=function(e){var t,i,s,n,o,r;for(t=this.parsed.length,this.parsed.push({array_index:t,group:!0,label:this.escapeExpression(e.label),children:0,disabled:e.disabled}),r=[],s=0,n=(o=e.childNodes).length;s<n;s++)i=o[s],r.push(this.add_option(i,t,e.disabled));return r},e.prototype.add_option=function(e,t,i){if("OPTION"===e.nodeName.toUpperCase())return""!==e.text?(null!=t&&(this.parsed[t].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:e.value,text:e.text,html:e.innerHTML,selected:e.selected,disabled:!0===i?i:e.disabled,group_array_index:t,classes:e.className,style:e.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1},e.prototype.escapeExpression=function(e){var t,i;return null==e||!1===e?"":/[\&\<\>\"\'\`]/.test(e)?(t={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},i=/&(?!\w+;)|[\<\>\"\'\`]/g,e.replace(i,function(e){return t[e]||"&amp;"})):e},e}()).select_to_array=function(e){var t,i,s,n,o;for(i=new r,s=0,n=(o=e.childNodes).length;s<n;s++)t=o[s],i.add_node(t);return i.parsed},i=function(){function i(e,t){this.form_field=e,this.options=null!=t?t:{},i.browser_is_supported()&&(this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers())}return i.prototype.set_default_values=function(){var t=this;return this.click_test_action=function(e){return t.test_active_click(e)},this.activate_action=function(e){return t.activate_field(e)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.result_single_selected=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text&&this.options.allow_single_deselect,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null==this.options.enable_split_word_search||this.options.enable_split_word_search,this.group_search=null==this.options.group_search||this.options.group_search,this.search_contains=this.options.search_contains||!1,this.single_backstroke_delete=null==this.options.single_backstroke_delete||this.options.single_backstroke_delete,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1,this.display_selected_options=null==this.options.display_selected_options||this.options.display_selected_options,this.display_disabled_options=null==this.options.display_disabled_options||this.options.display_disabled_options},i.prototype.set_default_text=function(){return this.form_field.getAttribute("data-placeholder")?this.default_text=this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.default_text=this.options.placeholder_text_multiple||this.options.placeholder_text||i.default_multiple_text:this.default_text=this.options.placeholder_text_single||this.options.placeholder_text||i.default_single_text,this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||i.default_no_result_text},i.prototype.mouse_enter=function(){return this.mouse_on_container=!0},i.prototype.mouse_leave=function(){return this.mouse_on_container=!1},i.prototype.input_focus=function(e){var t=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return t.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()},i.prototype.input_blur=function(e){var t=this;if(!this.mouse_on_container)return this.active_field=!1,setTimeout(function(){return t.blur_test()},100)},i.prototype.results_option_build=function(e){var t,i,s,n,o;for(t="",s=0,n=(o=this.results_data).length;s<n;s++)(i=o[s]).group?t+=this.result_add_group(i):t+=this.result_add_option(i),(null!=e?e.first:void 0)&&(i.selected&&this.is_multiple?this.choice_build(i):i.selected&&!this.is_multiple&&this.single_set_selected_text(i.text));return t},i.prototype.result_add_option=function(e){var t,i;return e.search_match&&this.include_option_in_results(e)?(t=[],e.disabled||e.selected&&this.is_multiple||t.push("active-result"),!e.disabled||e.selected&&this.is_multiple||t.push("disabled-result"),e.selected&&t.push("result-selected"),null!=e.group_array_index&&t.push("group-option"),""!==e.classes&&t.push(e.classes),i=""!==e.style.cssText?' style="'+e.style+'"':"",'<li class="'+t.join(" ")+'"'+i+' data-option-array-index="'+e.array_index+'">'+e.search_text+"</li>"):""},i.prototype.result_add_group=function(e){return(e.search_match||e.group_match)&&e.active_options>0?'<li class="group-result">'+e.search_text+"</li>":""},i.prototype.results_update_field=function(){if(this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.result_single_selected=null,this.results_build(),this.results_showing)return this.winnow_results()},i.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},i.prototype.results_search=function(e){return this.results_showing?this.winnow_results():this.results_show()},i.prototype.winnow_results=function(){var e,t,i,s,n,o,r,a,l,c,h,u,d;for(this.no_results_clear(),n=0,e=(r=this.get_search_text()).replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),s=this.search_contains?"":"^",i=new RegExp(s+e,"i"),c=new RegExp(e,"i"),h=0,u=(d=this.results_data).length;h<u;h++)(t=d[h]).search_match=!1,o=null,this.include_option_in_results(t)&&(t.group&&(t.group_match=!1,t.active_options=0),null!=t.group_array_index&&this.results_data[t.group_array_index]&&(0===(o=this.results_data[t.group_array_index]).active_options&&o.search_match&&(n+=1),o.active_options+=1),t.group&&!this.group_search||(t.search_text=t.group?t.label:t.html,t.search_match=this.search_string_match(t.search_text,i),t.search_match&&!t.group&&(n+=1),t.search_match?(r.length&&(a=t.search_text.search(c),l=t.search_text.substr(0,a+r.length)+"</em>"+t.search_text.substr(a+r.length),t.search_text=l.substr(0,a)+"<em>"+l.substr(a)),null!=o&&(o.group_match=!0)):null!=t.group_array_index&&this.results_data[t.group_array_index].search_match&&(t.search_match=!0)));return this.result_clear_highlight(),n<1&&r.length?(this.update_results_content(""),this.no_results(r)):(this.update_results_content(this.results_option_build()),this.winnow_results_set_highlight())},i.prototype.search_string_match=function(e,t){var i,s,n,o;if(t.test(e))return!0;if(this.enable_split_word_search&&(e.indexOf(" ")>=0||0===e.indexOf("["))&&(s=e.replace(/\[|\]/g,"").split(" ")).length)for(n=0,o=s.length;n<o;n++)if(i=s[n],t.test(i))return!0},i.prototype.choices_count=function(){var e,t,i;if(null!=this.selected_option_count)return this.selected_option_count;for(this.selected_option_count=0,e=0,t=(i=this.form_field.options).length;e<t;e++)i[e].selected&&(this.selected_option_count+=1);return this.selected_option_count},i.prototype.choices_click=function(e){if(e.preventDefault(),!this.results_showing&&!this.is_disabled)return this.results_show()},i.prototype.keyup_checker=function(e){var t,i;switch(t=null!=(i=e.which)?i:e.keyCode,this.search_field_scale(),t){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(e.preventDefault(),this.results_showing)return this.result_select(e);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},i.prototype.container_width=function(){return null!=this.options.width?this.options.width:this.form_field.offsetWidth+"px"},i.prototype.include_option_in_results=function(e){return!(this.is_multiple&&!this.display_selected_options&&e.selected)&&(!(!this.display_disabled_options&&e.disabled)&&!e.empty)},i.browser_is_supported=function(){return"Microsoft Internet Explorer"!==window.navigator.appName||document.documentMode>=8},i.default_multiple_text="Select Some Options",i.default_single_text="Select an Option",i.default_no_result_text="No results match",i}(),(l=jQuery).fn.extend({chosen:function(s){return i.browser_is_supported()?this.each(function(e){var t,i;i=(t=l(this)).data("chosen"),"destroy"===s&&i?i.destroy():i||t.data("chosen",new n(this,s))}):this}}),n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var i in t)o.call(t,i)&&(e[i]=t[i]);function s(){this.constructor=e}s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype}(t,i),t.prototype.setup=function(){return this.form_field_jq=l(this.form_field),this.current_selectedIndex=this.form_field.selectedIndex,this.is_rtl=this.form_field_jq.hasClass("chosen-rtl")},t.prototype.set_up_html=function(){var e,t;return(e=["chosen-container"]).push("chosen-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&e.push(this.form_field.className),this.is_rtl&&e.push("chosen-rtl"),t={class:e.join(" "),style:"width: "+this.container_width()+";",title:this.form_field.title},this.form_field.id.length&&(t.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen"),this.container=l("<div />",t),this.is_multiple?this.container.html('<ul class="chosen-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chosen-drop"><ul class="chosen-results"></ul></div>'):this.container.html('<a class="chosen-single chosen-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chosen-drop"><div class="chosen-search"><input type="text" autocomplete="off" /></div><ul class="chosen-results"></ul></div>'),this.form_field_jq.hide().after(this.container),this.dropdown=this.container.find("div.chosen-drop").first(),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chosen-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chosen-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chosen-search").first(),this.selected_item=this.container.find(".chosen-single").first()),this.results_build(),this.set_tab_index(),this.set_label_behavior(),this.form_field_jq.trigger("chosen:ready",{chosen:this})},t.prototype.register_observers=function(){var t=this;return this.container.bind("mousedown.chosen",function(e){t.container_mousedown(e)}),this.container.bind("mouseup.chosen",function(e){t.container_mouseup(e)}),this.container.bind("mouseenter.chosen",function(e){t.mouse_enter(e)}),this.container.bind("mouseleave.chosen",function(e){t.mouse_leave(e)}),this.search_results.bind("mouseup.chosen",function(e){t.search_results_mouseup(e)}),this.search_results.bind("mouseover.chosen",function(e){t.search_results_mouseover(e)}),this.search_results.bind("mouseout.chosen",function(e){t.search_results_mouseout(e)}),this.search_results.bind("mousewheel.chosen DOMMouseScroll.chosen",function(e){t.search_results_mousewheel(e)}),this.form_field_jq.bind("chosen:updated.chosen",function(e){t.results_update_field(e)}),this.form_field_jq.bind("chosen:activate.chosen",function(e){t.activate_field(e)}),this.form_field_jq.bind("chosen:open.chosen",function(e){t.container_mousedown(e)}),this.search_field.bind("blur.chosen",function(e){t.input_blur(e)}),this.search_field.bind("keyup.chosen",function(e){t.keyup_checker(e)}),this.search_field.bind("keydown.chosen",function(e){t.keydown_checker(e)}),this.search_field.bind("focus.chosen",function(e){t.input_focus(e)}),this.is_multiple?this.search_choices.bind("click.chosen",function(e){t.choices_click(e)}):this.container.bind("click.chosen",function(e){e.preventDefault()})},t.prototype.destroy=function(){return l(document).unbind("click.chosen",this.click_test_action),this.search_field[0].tabIndex&&(this.form_field_jq[0].tabIndex=this.search_field[0].tabIndex),this.container.remove(),this.form_field_jq.removeData("chosen"),this.form_field_jq.show()},t.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chosen-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus.chosen",this.activate_action),this.close_field()):(this.container.removeClass("chosen-disabled"),this.search_field[0].disabled=!1,this.is_multiple?void 0:this.selected_item.bind("focus.chosen",this.activate_action))},t.prototype.container_mousedown=function(e){if(!this.is_disabled&&(e&&"mousedown"===e.type&&!this.results_showing&&e.preventDefault(),null==e||!l(e.target).hasClass("search-choice-close")))return this.active_field?this.is_multiple||!e||l(e.target)[0]!==this.selected_item[0]&&!l(e.target).parents("a.chosen-single").length||(e.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),l(document).bind("click.chosen",this.click_test_action),this.results_show()),this.activate_field()},t.prototype.container_mouseup=function(e){if("ABBR"===e.target.nodeName&&!this.is_disabled)return this.results_reset(e)},t.prototype.search_results_mousewheel=function(e){var t,i,s;if(null!=(t=-(null!=(i=e.originalEvent)?i.wheelDelta:void 0)||(null!=(s=e.originialEvent)?s.detail:void 0)))return e.preventDefault(),"DOMMouseScroll"===e.type&&(t*=40),this.search_results.scrollTop(t+this.search_results.scrollTop())},t.prototype.blur_test=function(e){if(!this.active_field&&this.container.hasClass("chosen-container-active"))return this.close_field()},t.prototype.close_field=function(){return l(document).unbind("click.chosen",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chosen-container-active"),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},t.prototype.activate_field=function(){return this.container.addClass("chosen-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},t.prototype.test_active_click=function(e){return this.container.is(l(e.target).closest(".chosen-container"))?this.active_field=!0:this.close_field()},t.prototype.results_build=function(){return this.parsing=!0,this.selected_option_count=null,this.results_data=r.select_to_array(this.form_field),this.is_multiple?this.search_choices.find("li.search-choice").remove():this.is_multiple||(this.single_set_selected_text(),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?(this.search_field[0].readOnly=!0,this.container.addClass("chosen-container-single-nosearch")):(this.search_field[0].readOnly=!1,this.container.removeClass("chosen-container-single-nosearch"))),this.update_results_content(this.results_option_build({first:!0})),this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.parsing=!1},t.prototype.result_do_highlight=function(e){var t,i,s,n,o;if(e.length){if(this.result_clear_highlight(),this.result_highlight=e,this.result_highlight.addClass("highlighted"),n=(s=parseInt(this.search_results.css("maxHeight"),10))+(o=this.search_results.scrollTop()),(t=(i=this.result_highlight.position().top+this.search_results.scrollTop())+this.result_highlight.outerHeight())>=n)return this.search_results.scrollTop(t-s>0?t-s:0);if(i<o)return this.search_results.scrollTop(i)}},t.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},t.prototype.results_show=function(){return this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.container.hasClass("chosen-disabled")||this.container.addClass("chosen-with-drop"),this.form_field_jq.trigger("chosen:showing_dropdown",{chosen:this}),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results())},t.prototype.update_results_content=function(e){return this.search_results.html(e)},t.prototype.results_hide=function(){return this.results_showing&&(this.result_clear_highlight(),this.container.removeClass("chosen-with-drop"),this.form_field_jq.trigger("chosen:hiding_dropdown",{chosen:this})),this.results_showing=!1},t.prototype.set_tab_index=function(e){var t;if(this.form_field.tabIndex)return t=this.form_field.tabIndex,this.form_field.tabIndex=-1,this.search_field[0].tabIndex=t},t.prototype.set_label_behavior=function(){var t=this;if(this.form_field_label=this.form_field_jq.parents("label"),!this.form_field_label.length&&this.form_field.id.length&&(this.form_field_label=l("label[for='"+this.form_field.id+"']")),this.form_field_label.length>0)return this.form_field_label.bind("click.chosen",function(e){return t.is_multiple?t.container_mousedown(e):t.activate_field()})},t.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices_count()<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},t.prototype.search_results_mouseup=function(e){var t;if((t=l(e.target).hasClass("active-result")?l(e.target):l(e.target).parents(".active-result").first()).length)return this.result_highlight=t,this.result_select(e),this.search_field.focus()},t.prototype.search_results_mouseover=function(e){var t;if(t=l(e.target).hasClass("active-result")?l(e.target):l(e.target).parents(".active-result").first())return this.result_do_highlight(t)},t.prototype.search_results_mouseout=function(e){if(l(e.target).hasClass("active-result"))return this.result_clear_highlight()},t.prototype.choice_build=function(e){var t,i,s=this;return t=l("<li />",{class:"search-choice"}).html("<span>"+e.html+"</span>"),e.disabled?t.addClass("search-choice-disabled"):((i=l("<a />",{class:"search-choice-close","data-option-array-index":e.array_index})).bind("click.chosen",function(e){return s.choice_destroy_link_click(e)}),t.append(i)),this.search_container.before(t)},t.prototype.choice_destroy_link_click=function(e){if(e.preventDefault(),e.stopPropagation(),!this.is_disabled)return this.choice_destroy(l(e.target))},t.prototype.choice_destroy=function(e){if(this.result_deselect(e[0].getAttribute("data-option-array-index")))return this.show_search_field_default(),this.is_multiple&&this.choices_count()>0&&this.search_field.val().length<1&&this.results_hide(),e.parents("li").first().remove(),this.search_field_scale()},t.prototype.results_reset=function(){if(this.form_field.options[0].selected=!0,this.selected_option_count=null,this.single_set_selected_text(),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field)return this.results_hide()},t.prototype.results_reset_cleanup=function(){return this.current_selectedIndex=this.form_field.selectedIndex,this.selected_item.find("abbr").remove()},t.prototype.result_select=function(e){var t,i,s;if(this.result_highlight)return t=this.result_highlight,this.result_clear_highlight(),this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.is_multiple?t.removeClass("active-result"):(this.result_single_selected&&(this.result_single_selected.removeClass("result-selected"),s=this.result_single_selected[0].getAttribute("data-option-array-index"),this.results_data[s].selected=!1),this.result_single_selected=t),t.addClass("result-selected"),(i=this.results_data[t[0].getAttribute("data-option-array-index")]).selected=!0,this.form_field.options[i.options_index].selected=!0,this.selected_option_count=null,this.is_multiple?this.choice_build(i):this.single_set_selected_text(i.text),(e.metaKey||e.ctrlKey)&&this.is_multiple||this.results_hide(),this.search_field.val(""),(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[i.options_index].value}),this.current_selectedIndex=this.form_field.selectedIndex,this.search_field_scale())},t.prototype.single_set_selected_text=function(e){return null==e&&(e=this.default_text),e===this.default_text?this.selected_item.addClass("chosen-default"):(this.single_deselect_control_build(),this.selected_item.removeClass("chosen-default")),this.selected_item.find("span").text(e)},t.prototype.result_deselect=function(e){var t;return t=this.results_data[e],!this.form_field.options[t.options_index].disabled&&(t.selected=!1,this.form_field.options[t.options_index].selected=!1,this.selected_option_count=null,this.result_clear_highlight(),this.results_showing&&this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[t.options_index].value}),this.search_field_scale(),!0)},t.prototype.single_deselect_control_build=function(){if(this.allow_single_deselect)return this.selected_item.find("abbr").length||this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'),this.selected_item.addClass("chosen-single-with-deselect")},t.prototype.get_search_text=function(){return this.search_field.val()===this.default_text?"":l("<div/>").text(l.trim(this.search_field.val())).html()},t.prototype.winnow_results_set_highlight=function(){var e,t;if(null!=(e=(t=this.is_multiple?[]:this.search_results.find(".result-selected.active-result")).length?t.first():this.search_results.find(".active-result").first()))return this.result_do_highlight(e)},t.prototype.no_results=function(e){var t;return(t=l('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>')).find("span").first().html(e),this.search_results.append(t)},t.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},t.prototype.keydown_arrow=function(){var e;return this.results_showing&&this.result_highlight?(e=this.result_highlight.nextAll("li.active-result").first())?this.result_do_highlight(e):void 0:this.results_show()},t.prototype.keyup_arrow=function(){var e;return this.results_showing||this.is_multiple?this.result_highlight?(e=this.result_highlight.prevAll("li.active-result")).length?this.result_do_highlight(e.first()):(this.choices_count()>0&&this.results_hide(),this.result_clear_highlight()):void 0:this.results_show()},t.prototype.keydown_backstroke=function(){var e;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(e=this.search_container.siblings("li.search-choice").last()).length&&!e.hasClass("search-choice-disabled")?(this.pending_backstroke=e,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0},t.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},t.prototype.keydown_checker=function(e){var t,i;switch(t=null!=(i=e.which)?i:e.keyCode,this.search_field_scale(),8!==t&&this.pending_backstroke&&this.clear_backstroke(),t){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(e),this.mouse_on_container=!1;break;case 13:e.preventDefault();break;case 38:e.preventDefault(),this.keyup_arrow();break;case 40:e.preventDefault(),this.keydown_arrow()}},t.prototype.search_field_scale=function(){var e,t,i,s,n,o,r,a;if(this.is_multiple){for(0,o=0,s="position:absolute; left: -1000px; top: -1000px; display:none;",r=0,a=(n=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"]).length;r<a;r++)s+=(i=n[r])+":"+this.search_field.css(i)+";";return(e=l("<div />",{style:s})).text(this.search_field.val()),l("body").append(e),o=e.width()+25,e.remove(),o>(t=this.container.outerWidth())-10&&(o=t-10),this.search_field.css({width:o+"px"})}},t}()}).call(this);
//# sourceMappingURL=utility.min.js.map